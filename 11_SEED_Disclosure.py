import xml.etree.ElementTree as Et
from SEEDAPI import SEEDClient 
from ast import literal_eval
import numpy as np
import pandas as pd
from datetime import timedelta
from time import sleep
import requests, json, logging, time, smtplib, os, csv, xlrd, array


filename = os.path.join(os.path.dirname(os.path.realpath(__file__)), 'Disclosure Update.log')
logging.basicConfig(filename=filename, level=logging.DEBUG, filemode='w')
def createFolder(directory):
    try:
        if not os.path.exists(directory):
            os.makedirs(directory)
    except OSError:
        print ('Error: Creating directory. ' +  directory)
 
# Adds Compliance Status
def status(c):
	if c['property.property_view_id'] in Property_label_Lookup['Duplicate Report - Not for Disclosure']:
		return 'Delete this report'
	elif c['taxlot_view_id'] in label_Lookup['Exempted – Permanent']:
		return "Exempt from this year's disclosure"
	elif c['taxlot_view_id'] in label_Lookup['Exempted – This Cycle']:
		return "Exempt from this year's disclosure"
	elif c['taxlot_view_id'] in label_Lookup['Exempted – Disclosure']:
		return "Delete this report"
	elif c['taxlot_view_id'] in label_Lookup['Compliant']:
		return 'In Compliance'
	elif c['taxlot_view_id'] in label_Lookup['Violation – Incomplete/Inaccurate Data']:
		return 'Incomplete Report'
	elif c['taxlot_view_id'] in label_Lookup['Violation – Missing Report']:
		return 'No Report Received'

	else:
		return 'Data Under Review by DOEE'      
createFolder('./CSV output/')
ts =  time.gmtime()
tstamp =  (time.strftime("%Y%m%d_%H%M%S", ts))
tstamp2 = (time.strftime("%m/%d/%y %H:%M:%S %p", ts))

liveEnvironmentAccounts = pd.read_excel(open('WebServices_Reference_Document.XLSX', 'rb'), sheet_name='liveEnvironmentAccounts', dtype = str)
SEEDUserName = str(liveEnvironmentAccounts.loc[liveEnvironmentAccounts['Account Name']=='SEED','Account UserName'].values[0])
SEEDPassword = str(liveEnvironmentAccounts.loc[liveEnvironmentAccounts['Account Name']=='SEED','Account Password'].values[0])
SEEDorgID = str(liveEnvironmentAccounts.loc[liveEnvironmentAccounts['Account Name']=='SEED','Org Info'].values[0])

## Deletes old version of disclosure
SEEDClient = SEEDClient(SEEDUserName, SEEDPassword, '313')
payload = {'profile_id': '84'}
Disclosure = json.loads(SEEDClient.post_property_list_custom(payload, '318').text)
try:
	Disclosure_2 = pd.json_normalize(Disclosure['results'])
	PropertyIDs_to_delete =  Disclosure_2
	PropertyIDs_to_delete = list(PropertyIDs_to_delete['property_view_id'])
except:
	PropertyIDs_to_delete = []
Taxlots = pd.json_normalize(Disclosure['results'],record_path='related',meta = ['property_view_id','REPORTINGYEAR_68896'])
try: 
	Taxlots_to_delete = Taxlots
	Taxlots_to_delete = Taxlots_to_delete.drop_duplicates(subset='taxlot_view_id')
	Taxlots_to_delete = list(Taxlots_to_delete['taxlot_view_id'])
except: 
	Taxlots_to_delete = []
print (len(PropertyIDs_to_delete),len(Taxlots_to_delete))


property_payload = {'property_view_ids': PropertyIDs_to_delete}
deleteresponse = SEEDClient.delete_properties(property_payload)

taxlot_payload = {'taxlot_view_ids': Taxlots_to_delete}
deleteresponse = SEEDClient.delete_taxlots(taxlot_payload)

## Resets SEED Account
SEEDClient.orgID = SEEDorgID
#SEEDClient = SEEDClient(SEEDUserName, SEEDPassword, SEEDorgID)

## Creates Label Dictionary
SEED_Label_List = json.loads(SEEDClient.post_taxlot_label_list().text)

label_Lookup_temp1 = []
label_Lookup_temp2 = []
for item in SEED_Label_List:
	label_Lookup_temp1.append(item['name'])
	label_Lookup_temp2.append(item['is_applied'])
label_Lookup = dict(zip(label_Lookup_temp1,label_Lookup_temp2))

SEED_Property_Label_List = json.loads(SEEDClient.post_property_filter_list().text)
Property_label_Lookup_temp1 = []
Property_label_Lookup_temp2 = []
for item in SEED_Property_Label_List:
	Property_label_Lookup_temp1.append(item['name'])
	Property_label_Lookup_temp2.append(item['is_applied'])
Property_label_Lookup = dict(zip(Property_label_Lookup_temp1,Property_label_Lookup_temp2))

# Gets Reporting Year

reporting_years_temp = json.loads(SEEDClient.get_cycles().text)
reporting_years_temp2 = reporting_years_temp['cycles']


## Runs through each year in SEED
data_View5 = pd.DataFrame()
for item in reporting_years_temp2:
	SEEDcycleID = str(item['id'])
	reporting_year = pd.to_datetime(item['end']).year
	###
	if item['name'] != 'CY 2018':
		pass
	else:
		SEEDcycleID = str(item['id'])
		reporting_year = pd.to_datetime(item['end']).year
		print (reporting_year)
	###
	
	## Creates Disclosure table
	try:
		SEEDClient.orgID = SEEDorgID
		data_View = json.loads(SEEDClient.get_taxlot_list(SEEDcycleID).text)
		data_View2 = pd.json_normalize(data_View['results'])
		

		data_View3 = pd.json_normalize(data_View['results'],record_path='related',meta = 'taxlot_view_id',record_prefix = 'property.')
		data_View4 = pd.merge(data_View2, data_View3, how='left',on='taxlot_view_id') 
		data_View4.drop(columns=['related'], inplace = True)
		data_View4.to_excel('CSV output\\temp'+tstamp +'.xlsx')
		

		## Applies Status
		data_View4['Compliance Status'] = data_View4.apply(status,axis = 1)
		data_View4['property.Period Ending Date_64755'] = pd.to_datetime(data_View4['property.Period Ending Date_64755'], errors='coerce', format='%m/%d/%Y')

		data_View4['Year Built_63383'] = data_View4['Year Built_63383'].fillna(	data_View4['property.year_built_63342'])
		data_View4['Year Built_63383'] = pd.to_datetime(data_View4['Year Built_63383'], errors='coerce', format='%Y').dt.year

		data_View4.loc[(data_View4['Year Built_63383'] >= data_View4['property.Period Ending Date_64755'].dt.year - 1), 'Compliance Status'] = "Exempt from this year's disclosure"
		data_View4['property.pm_property_id_63304'] = data_View4['property.pm_property_id_63304'].fillna('')
		data_View4['Compliance Status'] = np.where((data_View4['property.pm_property_id_63304'] != '')& (data_View4['Compliance Status'] == 'No Report Received'), 'Data Under Review by DOEE',data_View4['Compliance Status'])

		#Converts string to numbers 
		data_View4['property.Occupancy_63598'] = pd.to_numeric(data_View4['property.Occupancy_63598']).fillna(0)
		data_View4['property.Fuel Oil #1 Use (kBtu)_63637'] = pd.to_numeric(data_View4['property.Fuel Oil #1 Use (kBtu)_63637']).fillna(0)
		data_View4['property.Fuel Oil #2 Use (kBtu)_63639'] = pd.to_numeric(data_View4['property.Fuel Oil #2 Use (kBtu)_63639']).fillna(0)
		data_View4['property.Fuel Oil #4 Use (kBtu)_63641'] = pd.to_numeric(data_View4['property.Fuel Oil #4 Use (kBtu)_63641']).fillna(0)
		data_View4['property.Fuel Oil #5 & 6 Use (kBtu)_63643'] = pd.to_numeric(data_View4['property.Fuel Oil #5 & 6 Use (kBtu)_63643']).fillna(0)
		data_View4['property.Diesel #2 Use (kBtu)_63645'] = pd.to_numeric(data_View4['property.Diesel #2 Use (kBtu)_63645']).fillna(0)
		data_View4['property.Propane Use (kBtu)_63649'] = pd.to_numeric(data_View4['property.Propane Use (kBtu)_63649']).fillna(0)
		data_View4['property.District Steam Use (kBtu)_63651'] = pd.to_numeric(data_View4['property.District Steam Use (kBtu)_63651']).fillna(0)
		data_View4['property.District Chilled Water Use (kBtu)_63655'] = pd.to_numeric(data_View4['property.District Chilled Water Use (kBtu)_63655']).fillna(0)
		data_View4['property.District Hot Water Use (kBtu)_63653'] = pd.to_numeric(data_View4['property.District Hot Water Use (kBtu)_63653']).fillna(0)
		data_View4['property.Electricity Use - Generated From Onsite Renewable Systems And Used Onsite (kWh)_63629'] = pd.to_numeric(data_View4['property.Electricity Use - Generated From Onsite Renewable Systems And Used Onsite (kWh)_63629']).fillna(0)
		data_View4['property.Water Score (Multifamily Only)_63501'] = data_View4['property.Water Score (Multifamily Only)_63501'].fillna('')
		data_View4['property.pm_parent_property_id_63305'] = data_View4['property.pm_parent_property_id_63305'].fillna('')
		data_View4['property.pm_parent_property_id_63305'] = data_View4['property.pm_parent_property_id_63305'].replace('Not Applicable: Standalone Property','')
		data_View4['property.Parent Property Name_63444'] = data_View4['property.Parent Property Name_63444'].fillna('')
		data_View4['property.Parent Property Name_63444'] = data_View4['property.Parent Property Name_63444'].replace('Not Applicable: Standalone Property','')
		
		data_View4['property.Property GFA - Calculated (Buildings) (ft2)_63468'] = pd.to_numeric(data_View4['property.Property GFA - Calculated (Buildings) (ft2)_63468']).fillna(0)
		data_View4['property.energy_score_63334'] = pd.to_numeric(data_View4['property.energy_score_63334']).fillna(0)
		data_View4['property.site_eui_63352'] = pd.to_numeric(data_View4['property.site_eui_63352']).fillna(0)
		data_View4['property.site_eui_weather_normalized_63353'] = pd.to_numeric(data_View4['property.site_eui_weather_normalized_63353']).fillna(0)
		data_View4['property.source_eui_63355'] = pd.to_numeric(data_View4['property.source_eui_63355']).fillna(0)
		data_View4['property.source_eui_weather_normalized_63356'] = pd.to_numeric(data_View4['property.source_eui_weather_normalized_63356']).fillna(0)
		data_View4['property.Total GHG Emissions (Metric Tons CO2e)_63671'] = pd.to_numeric(data_View4['property.Total GHG Emissions (Metric Tons CO2e)_63671']).fillna(0)
		data_View4['property.Total GHG Emissions Intensity (kgCO2e/ft2)_63673'] = pd.to_numeric(data_View4['property.Total GHG Emissions Intensity (kgCO2e/ft2)_63673']).fillna(0)
		data_View4['property.Water Use (All Water Sources) (kgal)_63495'] = pd.to_numeric(data_View4['property.Water Use (All Water Sources) (kgal)_63495']).fillna(0)
		data_View4['property.Electricity Use - Grid Purchase (kWh)_63627'] = pd.to_numeric(data_View4['property.Electricity Use - Grid Purchase (kWh)_63627']).fillna(0)
		data_View4['property.Natural Gas Use (therms)_63635'] = pd.to_numeric(data_View4['property.Natural Gas Use (therms)_63635']).fillna(0)
		data_View4['property.Elec - Jan_65690'] = pd.to_numeric(data_View4['property.Elec - Jan_65690']).fillna(0)
		data_View4['property.Elec - Feb_65688'] = pd.to_numeric(data_View4['property.Elec - Feb_65688']).fillna(0)
		data_View4['property.Elec - March_65686'] = pd.to_numeric(data_View4['property.Elec - March_65686']).fillna(0)
		data_View4['property.Elec - Apr_65684'] = pd.to_numeric(data_View4['property.Elec - Apr_65684']).fillna(0)
		data_View4['property.Elec - May_65682'] = pd.to_numeric(data_View4['property.Elec - May_65682']).fillna(0)
		data_View4['property.Elec - June_65680'] = pd.to_numeric(data_View4['property.Elec - June_65680']).fillna(0)
		data_View4['property.Elec - July_65678'] = pd.to_numeric(data_View4['property.Elec - July_65678']).fillna(0)
		data_View4['property.Elec - Aug_65676'] = pd.to_numeric(data_View4['property.Elec - Aug_65676']).fillna(0)
		data_View4['property.Elec - Sept_65674'] = pd.to_numeric(data_View4['property.Elec - Sept_65674']).fillna(0)
		data_View4['property.Elec - Oct_65672'] = pd.to_numeric(data_View4['property.Elec - Oct_65672']).fillna(0)
		data_View4['property.Elec - Nov_65670'] = pd.to_numeric(data_View4['property.Elec - Nov_65670']).fillna(0)
		data_View4['property.Elec - Dec_65668'] = pd.to_numeric(data_View4['property.Elec - Dec_65668']).fillna(0)
		data_View4['property.NG - Jan_65714'] = pd.to_numeric(data_View4['property.NG - Jan_65714']).fillna(0)
		data_View4['property.NG - Feb_65712'] = pd.to_numeric(data_View4['property.NG - Feb_65712']).fillna(0)
		data_View4['property.NG - March_65710'] = pd.to_numeric(data_View4['property.NG - March_65710']).fillna(0)
		data_View4['property.NG - Apr_65708'] = pd.to_numeric(data_View4['property.NG - Apr_65708']).fillna(0)
		data_View4['property.NG - May_65706'] = pd.to_numeric(data_View4['property.NG - May_65706']).fillna(0)
		data_View4['property.NG - June_65704'] = pd.to_numeric(data_View4['property.NG - June_65704']).fillna(0)
		data_View4['property.NG - July_65702'] = pd.to_numeric(data_View4['property.NG - July_65702']).fillna(0)
		data_View4['property.NG - Aug_65700'] = pd.to_numeric(data_View4['property.NG - Aug_65700']).fillna(0)
		data_View4['property.NG - Sept_65698'] = pd.to_numeric(data_View4['property.NG - Sept_65698']).fillna(0)
		data_View4['property.NG - Oct_65696'] = pd.to_numeric(data_View4['property.NG - Oct_65696']).fillna(0)
		data_View4['property.NG - Nov_65694'] = pd.to_numeric(data_View4['property.NG - Nov_65694']).fillna(0)
		data_View4['property.NG - Dec_65692'] = pd.to_numeric(data_View4['property.NG - Dec_65692']).fillna(0) 
		data_View4['SumOfGBA_63380'] = pd.to_numeric(data_View4['SumOfGBA_63380']).fillna(0) 
		data_View4['updated_63330'] = data_View4['property.updated_63328'].str.replace("(T).*","")

		
		"""
		data_View4['property.District Chilled Water Use (kBtu)_63655'] = pd.to_numeric(data_View4['property.District Chilled Water Use (kBtu)_63655']).fillna(0)
		data_View4['property.District Hot Water Use (kBtu)_63653'] = pd.to_numeric(data_View4['property.District Hot Water Use (kBtu)_63653']).fillna(0)
		data_View4['property.District Steam Use (kBtu)_63651'] = pd.to_numeric(data_View4['property.District Steam Use (kBtu)_63651']).fillna(0)
		"""
		#Applies Filters and sums fields
		data_View4.loc[(data_View4['property.Occupancy_63598'] < 50) & (data_View4['property.Primary Property Type - Portfolio Manager-Calculated_65237'] == 'Multifamily Housing') & (data_View4['property.energy_score_63334'] >= 95), 'property.energy_score_63334'] = ''
		data_View4['property.fuel_use'] = data_View4.fillna(0)['property.Fuel Oil #1 Use (kBtu)_63637'] + data_View4.fillna(0)['property.Fuel Oil #2 Use (kBtu)_63639'] + data_View4.fillna(0)['property.Fuel Oil #4 Use (kBtu)_63641'] + data_View4.fillna(0)['property.Fuel Oil #5 & 6 Use (kBtu)_63643'] + data_View4.fillna(0)['property.Diesel #2 Use (kBtu)_63645'] + data_View4.fillna(0)['property.Propane Use (kBtu)_63649']
		data_View4['property.district_water_use'] = data_View4['property.District Chilled Water Use (kBtu)_63655'] + data_View4['property.District Hot Water Use (kBtu)_63653'] + data_View4['property.District Steam Use (kBtu)_63651']
		#data_View4['property.fuel_use'] = data_View4['property.fuel_use'].replace(0, '')
		#data_View4['property.district_water_use'] = data_View4['property.district_water_use'].replace(0, '')
		data_View4['REPORTINGYEAR'] = reporting_year
		#data_View4.to_excel('CSV output\\temp_'+tstamp +'.xlsx')


		#Clear fields for exmept reports and drop duplicate reports
		property_data_cols = [col for col in data_View4.columns if col.startswith('property.')]
		data_View4.loc[data_View4['Compliance Status'] == "Exempt from this year's disclosure", property_data_cols] = ''
		data_View4.loc[data_View4['Compliance Status'] == "Exempt from this year's disclosure", updated_63330] = ''
		data_View4.loc[data_View4['Compliance Status'] == "No Report Received", property_data_cols] = ''
		data_View4.loc[data_View4['Compliance Status'] == "No Report Received", updated_63330] = ''
		data_View4.drop(data_View4[data_View4['Compliance Status'] == 'Delete this report'].index, inplace= True)
		data_View4.drop(columns = ['REGISTERED AGENT EMAIL_76069','property.Data Quality Checker Run_74123', 'property.Jurisdiction Tax Lot ID_72377', 'property.Alert - Energy - No meters selected for metrics_74082','SECOND OWNER CITY_72396','SECOND OWNER ZIP_72400', 'Public Building_74121', 'TAX ADDRESS_76068', 'Table_origin (Invalid Footprint)_74170','SECOND OWNER ADDRESS 2_72394', 'SECOND OWNER ADDRESS 1_72392','SECOND OWNER STATE_72398', 'SECOND OWNERNAME_72402','property.district_water_use', 'property.Electricity Use - Grid Purchase And Generated From Onsite Renewable Systems (kWh)_63625','property.Estimated Data Flag - Data Center IT Equipment Input Meter_71242','property.Estimated Data Flag - Data Center PDU Input Meter_71240','property.Estimated Data Flag - Data Center PDU Output Meter_71241','property.Estimated Data Flag - Data Center UPS Output Meter_71239','property.Estimated Data Flag - Municipally Supplied Potable Water - Indoor Use_71235','property.Estimated Data Flag - Municipally Supplied Potable Water - Outdoor Use_71236','property.Estimated Data Flag - Municipally Supplied Reclaimed Water - Indoor Use_71237','property.Estimated Data Flag - Municipally Supplied Reclaimed Water - Outdoor Use_71238','property.Hotel - Gym/fitness Center Floor Area (ft2)_71243','property.Metered Areas (Water)_71234','property.Property Use Detail Alerts_71288','property.Weather Station Name_71289','property.Zoo - Gross Floor Area (ft2)_71291','property.Estimated Data Flag - Data Center IT Equipment Input Meter_71242','property.ENERGY STAR Certification - Application Status_71290','property.Water Score_64806', 'property.Period Ending Date_64755', 'address_line_2_63314','taxlot_view_id','CAREOFNAME_63372','DC Real Property ID_66748', 'Exempt 2011 Reporting (2010 Data)_63435', 'property.year_ending_63337', 'Exempt 2012 Reporting (2011 Data)_63433', 'Exempt 2013 Reporting (2012 Data)_63431', 'Exempt 2014 Reporting (2013 Data)_63429', 'Exempt 2015 Reporting (2014 Data)_63427', 'Exempt 2016 Reporting (2015 Data)_63425', 'Exempt 2017 Reporting (2016 Data)_63423', 'Exempt 2018 Reporting (2017 Data)_63421', 'Exempt 2019 Reporting (2018 Data)_63419', 'Exempt 2020 Reporting (2019 Data)_63417', 'ExemptTotally_63415', 'Exemption Reason_63437', 'Foreign_63413', 'Jurisdiction Tax Lot ID_65232', 'OWNER ADDRESS 1_63387', 'OWNER ADDRESS 2_63389', 'OWNER CITY_63391', 'OWNER STATE_63393', 'OWNER ZIP_63395', 'REGISTERED AGENT ADDRESS 2_66758', 'REGISTERED AGENT ADDRESS_63399', 'REGISTERED AGENT CITY_63401', 'REGISTERED AGENT NAME_63397', 'REGISTERED AGENT STATE_63403', 'REGISTERED AGENT ZIP_63405', 'Recent Sale Date_63385', 'USE_SDESC_63407', 'block_number_63366', 'bounding_box', 'created_63331', 'custom_id_1_63310', 'district_63367', 'geocoding_confidence_67165', 'id', 'latitude_67669', 'long_lat', 'longitude_67670', 'notes_count', 'number_properties_63365', 'taxlot_footprint_67397', 'taxlot_state_id', 'ulid_67395', 'property.% Difference From National Median Site EUI_63609', 'property.% Difference From National Median Source EUI_63611', 'property.2nd Largest Property Use - Gross Floor Area (ft2)_63484', 'property.2nd Largest Property Use Type_63482', 'property.3rd Largest Property Use Type - Gross Floor Area (ft2)_63488', 'property.3rd Largest Property Use Type_63486', 'property.Adult Education - Gross Floor Area (ft2)_65718', 'property.Alert - Data Center Issue (with Estimates, IT Configuration, Or IT Meter)_63577', 'property.Alert - Energy - No Meters Selected For Metrics_63585', 'property.Alert - Energy Meter Has Gaps_63581', 'property.Alert - Energy Meter Has Less Than 12 Full Calendar Months Of Data_63579', 'property.Alert - Energy Meter Has Overlaps_63583', 'property.Alert - Energy Meter Has Single Entry More Than 65 Days_63587', 'property.Alert - Gross Floor Area Is 0 Ft2_63573', 'property.Alert - No Meters Are Associated With This Property_65242', 'property.Alert - Property Has No Uses_63575', 'property.Alert - Water - No Meters Selected For Metrics_63595', 'property.Alert - Water Meter Has Gaps_63591', 'property.Alert - Water Meter Has Less Than 12 Full Calendar Months Of Data_63589', 'property.Alert - Water Meter Has Overlaps_63593', 'property.Alternative Water Generated On Site - Mixed Indoor/Outdoor Use (kgal)_65244', 'property.Ambulatory Surgical Center - Gross Floor Area (ft2)_65720', 'property.Aquarium - Gross Floor Area (ft2)_65722', 'property.Automobile Dealership - Gross Floor Area (ft2)_65724', 'property.Avoided Emissions - Offsite Green Power (Metric Tons CO2e)_63691', 'property.Avoided Emissions - Onsite Green Power (Metric Tons CO2e)_63689', 'property.Bank Branch - Computer Density (Number Per 1,000 Ft2)_63986', 'property.Bank Branch - Gross Floor Area (ft2)_63865', 'property.Bank Branch - Number Of Computers_63980', 'property.Bank Branch - Number Of Workers On Main Shift_63992', 'property.Bank Branch - Percent That Can Be Cooled_63982', 'property.Bank Branch - Percent That Can Be Heated_63984', 'property.Bank Branch - Weekly Operating Hours_63988', 'property.Bank Branch - Worker Density (Number Per 1,000 Ft2)_63990', 'property.Bar/Nightclub - Gross Floor Area (ft2)_65726', 'property.Barracks- Gross Floor Area (ft2)_65728', 'property.Bowling Alley - Gross Floor Area (ft2)_65730', 'property.Casino - Gross Floor Area (ft2)_65732', 'property.CoStar Property ID_64224', 'property.Coal - Anthracite Use (kBtu)_63940', 'property.Coal - Bituminous Use (kBtu)_63942', 'property.Coke Use (kBtu)_63944', 'property.College/University - Gross Floor Area (ft2)_63867', 'property.Construction Status_63600', 'property.Convenience Store With Gas Station - Gross Floor Area (ft2)_65734', 'property.Convenience Store Without Gas Station - Gross Floor Area (ft2)_63869', 'property.Convention Center - Gross Floor Area (ft2)_65736', 'property.Courthouse - Computer Density (Number Per 1,000 Ft2)_64000', 'property.Courthouse - Gross Floor Area (ft2)_63871', 'property.Courthouse - Number Of Computers_63994', 'property.Courthouse - Number Of Workers On Main Shift_64006', 'property.Courthouse - Percent That Can Be Cooled_63996', 'property.Courthouse - Percent That Can Be Heated_63998', 'property.Courthouse - Weekly Operating Hours_64002', 'property.Courthouse - Worker Density (Number Per 1,000 Ft2)_64004', 'property.Custom Property ID 1 - ID_65235', 'property.Custom Property Id 1 Id_64766', 'property.DC Real Property ID_63931', 'property.Data Center - Cooling Equipment Redundancy_63755', 'property.Data Center - Energy Estimates Applied_63757', 'property.Data Center - Gross Floor Area (ft2)_63753', 'property.Data Center - IT Energy Configuration_63759', 'property.Data Center - IT Equipment Input Meter (kWh)_63769', 'property.Data Center - IT Site Energy (kWh)_63771', 'property.Data Center - IT Source Energy (kBtu)_64010', 'property.Data Center - National Median PUE_64012', 'property.Data Center - PDU Input Meter (kWh)_63765', 'property.Data Center - PDU Output Meter (kWh)_63767', 'property.Data Center - PUE_64008', 'property.Data Center - UPS Output Meter (kWh)_63763', 'property.Data Center - UPS System Redundancy_63761', 'property.Data Quality Checker - Date Run_63571', 'property.Data Quality Checker Run?_64230', 'property.Default Data Flag - Multifamily_65716', 'property.Default Values_63527', 'property.Diesel #2 Use (kBtu)_63645', 'property.Direct GHG Emissions (Metric Tons CO2e)_63675', 'property.District Of Columbia Building Unique ID_63457', 'property.District Of Columbia Building Unique Id_64764', 'property.District Of Columbia Real Property Unique ID - Additional Web Services_65660', 'property.District Of Columbia Real Property Unique ID - Web Services_65658', 'property.District Of Columbia Real Property Unique ID_65234', 'property.District Of Columbia Real Property Unique Id_64762', 'property.Diversion Rate (%)_63669', 'property.Drinking Water Treatment & Distribution - Gross Floor Area (ft2)_65738', 'property.EGRID Output Emissions Rate (kgCO2e/MBtu)_63934', 'property.ENERGY STAR Certification - Eligibility_63701', 'property.ENERGY STAR Certification - Last Approval Date_63697', 'property.ENERGY STAR Certification - Next Eligible Date_63699', 'property.ENERGY STAR Certification - Profile Published_65247', 'property.ENERGY STAR Certification - Year(s) Certified_63695', 'property.Electricity Use - Generated From Onsite Renewable Systems (kWh)_63631', 'property.Electricity Use - Generated From Onsite Renewable Systems And Exported (kWh)_63633', 'property.Electricity Use - Grid Purchase (kBtu)_63936', 'property.Electricity Use - Grid Purchase And Generated From Onsite Renewable Systems (kBtu)_65823', 'property.Enclosed Mall - Gross Floor Area (ft2)_65740', 'property.Energy Current Date_63507', 'property.Energy/Power Station - Gross Floor Area (ft2)_65742', 'property.Estimated Data Flag -  Data Center IT Equipment Input Meter_63567', 'property.Estimated Data Flag -  Data Center PDU Input Meter_63563', 'property.Estimated Data Flag -  Data Center PDU Output Meter_63565', 'property.Estimated Data Flag -  Data Center UPS Output Meter_63561', 'property.Estimated Data Flag -  Municipally Supplied Potable Water - Indoor Use_63549', 'property.Estimated Data Flag -  Municipally Supplied Potable Water - Outdoor Use_65229', 'property.Estimated Data Flag -  Municipally Supplied Reclaimed Water - Indoor Use_63555', 'property.Estimated Data Flag -  Municipally Supplied Reclaimed Water - Outdoor Use_63557', 'property.Estimated Data Flag - Coal (anthracite)_63950', 'property.Estimated Data Flag - Coal (bitumiNous)_63952', 'property.Estimated Data Flag - Coke_63954', 'property.Estimated Data Flag - Diesel_63956', 'property.Estimated Data Flag - District Chilled Water_63547', 'property.Estimated Data Flag - District Hot Water_63545', 'property.Estimated Data Flag - District Steam_63543', 'property.Estimated Data Flag - Electricity (Grid Purchase)_63533', 'property.Estimated Data Flag - Electricity (Onsite Solar)_63535', 'property.Estimated Data Flag - Fuel Oil (No. 1)_63539', 'property.Estimated Data Flag - Fuel Oil (No. 2)_63541', 'property.Estimated Data Flag - Fuel Oil (No. 4)_63958', 'property.Estimated Data Flag - Fuel Oil (No. 5 And No. 6)_63960', 'property.Estimated Data Flag - Kerosene_63962', 'property.Estimated Data Flag - Municipally Supplied Potable Water: Mixed Indoor/Outdoor Use_63553', 'property.Estimated Data Flag - Municipally Supplied Reclaimed Water: Mixed Indoor/Outdoor Use_63559', 'property.Estimated Data Flag - Natural Gas_63537', 'property.Estimated Data Flag - Other_63964', 'property.Estimated Data Flag - Propane_63966', 'property.Estimated Data Flag - Wood_63968', 'property.Estimated Data Flag Municipally Supplied Potable Water Outdoor Use_64853', 'property.Estimated Values - Energy_63529', 'property.Estimated Values - Water_63531', 'property.Fast Food Restaurant - Gross Floor Area (ft2)_63873', 'property.Financial Office - Computer Density (Number Per 1,000 Ft2)_63807', 'property.Financial Office - Gross Floor Area (ft2)_63805', 'property.Financial Office - Number Of Computers_63809', 'property.Financial Office - Number Of Workers On Main Shift_63811', 'property.Financial Office - Percent That Can Be Cooled_63813', 'property.Financial Office - Percent That Can Be Heated_63815', 'property.Financial Office - Weekly Operating Hours_63817', 'property.Financial Office - Worker Density (Number Per 1,000 Ft2)_63819', 'property.Fire Station - Gross Floor Area (ft2)_63911', 'property.Fitness Center/Health Club/Gym - Gross Floor Area (ft2)_63875', 'property.Food Sales - Gross Floor Area (ft2)_65744', 'property.Food Service - Gross Floor Area (ft2)_63877', 'property.Fuel Oil #1 Use (kBtu)_63637', 'property.Fuel Oil #2 Use (kBtu)_63639', 'property.Fuel Oil #4 Use (kBtu)_63641', 'property.Fuel Oil #5 & 6 Use (kBtu)_63643', 'property.Green Power - Offsite (kWh)_63683', 'property.Green Power - Onsite (kWh)_63681', 'property.Hospital (General Medical & Surgical) - Gross Floor Area (ft2)_63879', 'property.Hospital (General Medical & Surgical) - Laboratory_64020', 'property.Hospital (General Medical & Surgical) - Licensed Bed Capacity Density (Number Per 1,000 Ft2)_65831', 'property.Hospital (General Medical & Surgical) - MRI Density (Number Per 1,000 Ft2)_65833', 'property.Hospital (General Medical & Surgical) - Maximum Number Of Floors_64024', 'property.Hospital (General Medical & Surgical) - Number Of MRI Machines_64016', 'property.Hospital (General Medical & Surgical) - Number Of Staffed Beds_64018', 'property.Hospital (General Medical & Surgical) - Onsite Laundry Facility_64022', 'property.Hospital (General Medical & Surgical) - Owned By_64026', 'property.Hospital (General Medical & Surgical) - Percent That Can Be Heated_65837', 'property.Hospital (General Medical & Surgical) - Staffed Bed Density (Number Per 1,000 Ft2)_65839', 'property.Hospital (General Medical & Surgical) - Tertiary Care_64028', 'property.Hospital (General Medical & Surgical)- Full Time Equivalent (FTE) Workers_64014', 'property.Hotel - Amount Of Laundry Processed On-site Annually (short Tons/year)_63775', 'property.Hotel - Commercial Refrigeration Density (Number Per 1,000 Ft2)_63777', 'property.Hotel - Cooking Facilities_63779', 'property.Hotel - Full Service Spa Floor Area (ft2)_63781', 'property.Hotel - Gross Floor Area (ft2)_63773', 'property.Hotel - Gym/fitness  Center Floor Area (ft2)_63783', 'property.Hotel - Hours Per Day Guests Onsite_63785', 'property.Hotel - Number Of Commercial Refrigeration/Freezer Units_63787', 'property.Hotel - Number Of Guest Meals Served Per Year_63789', 'property.Hotel - Number Of Rooms_63791', 'property.Hotel - Number Of Workers On Main Shift_63793', 'property.Hotel - Percent That Can Be Cooled_63795', 'property.Hotel - Percent That Can Be Heated_63797', 'property.Hotel - Room Density (Number Per 1,000 Ft2)_63799', 'property.Hotel - Type Of Laundry Facility_63801', 'property.Hotel - Worker Density (Number Per 1,000 Ft2)_63803', 'property.Ice/Curling Rink - Gross Floor Area (ft2)_65746', 'property.Indirect GHG Emissions (Metric Tons CO2e)_63677', 'property.Indoor Arena - Gross Floor Area (ft2)_65748', 'property.Indoor Water Use (All Water Sources) (kgal)_63657', 'property.Indoor Water Use Intensity (All Water Sources) (gal/ft2)_63659', 'property.Irrigated Area (ft2)_63497', 'property.K-12 School - Computer Density (Number Per 1,000 Ft2)_63823', 'property.K-12 School - Cooking Facilities_63825', 'property.K-12 School - Gross Floor Area (ft2)_63821', 'property.K-12 School - Gymnasium Floor Area (ft2)_63827', 'property.K-12 School - High School_63829', 'property.K-12 School - Months In Use_63831', 'property.K-12 School - Number Of Computers_63833', 'property.K-12 School - Number Of Walk-in Refrigeration/Freezer Units_63835', 'property.K-12 School - Number Of Workers On Main Shift_63837', 'property.K-12 School - Percent That Can Be Cooled_63839', 'property.K-12 School - Percent That Can Be Heated_63841', 'property.K-12 School - Refrigeration Density (Number Per 1,000 Ft2)_63843', 'property.K-12 School - School District_63845', 'property.K-12 School - Student Seating Capacity_63847', 'property.K-12 School - Student Seating Density (Number Per 1,000 Ft2)_63849', 'property.K-12 School - Weekend Operation_63851', 'property.K-12 School - Worker Density (Number Per 1,000 Ft2)_63853', 'property.Kerosene Use (kBtu)_63647', 'property.LAST MODIFIED DATE PROPERTY_64814', 'property.LEED US Project ID_63460', 'property.LIST OF ALL PROPERTY USE TYPES_64782', 'property.Laboratory - Gross Floor Area (ft2)_65750', 'property.Largest Property Use Type - Gross Floor Area (ft2)_63480', 'property.Largest Property Use Type_63478', 'property.Last Modified By - Electric Meters_63515', 'property.Last Modified By - Gas Meters_63519', 'property.Last Modified By - Non-Electric Non-Gas Energy Meters_63523', 'property.Last Modified By - Property_64226', 'property.Last Modified By - Water Meters_64228', 'property.Last Modified Date - Electric Meters_63513', 'property.Last Modified Date - Gas Meters_63517', 'property.Last Modified Date - Non-Electric Non-Gas Energy Meters_63521', 'property.Last Modified Date - Property_63511', 'property.Last Modified Date - Water Meters_63525', 'property.Leed Us Project Id_64768', 'property.Library - Gross Floor Area (ft2)_63881', 'property.Lifestyle Center - Gross Floor Area (ft2)_65752', 'property.List Of All Property Use Types At Property_63476', 'property.Mailing Center/Post Office - Gross Floor Area (ft2)_65754', 'property.Manufacturing/Industrial Plant - Gross Floor Area (ft2)_65756', 'property.Map ID_64235', 'property.Medical Office - Gross Floor Area (ft2)_63883', 'property.Medical Office - Number Of Workers On Main Shift_64042', 'property.Medical Office - Percent That Can Be Cooled_64044', 'property.Medical Office - Percent That Can Be Heated_64046', 'property.Medical Office - Weekly Operating Hours_64048', 'property.Movie Theater - Gross Floor Area (ft2)_65758', 'property.Multifamily Housing - Government Subsidized Housing_63721', 'property.Multifamily Housing - Gross Floor Area (ft2)_63719', 'property.Multifamily Housing - Maximum Number Of Floors_63974', 'property.Multifamily Housing - Number Of Bedrooms Density (Number Per 1,000 Ft2)_63725', 'property.Multifamily Housing - Number Of Bedrooms_63723', 'property.Multifamily Housing - Number Of Dishwasher Hookups In All Units_63972', 'property.Multifamily Housing - Number Of Dishwasher Hookups In Common Area(s)_65828', 'property.Multifamily Housing - Number Of Dishwasher Hookups_65826', 'property.Multifamily Housing - Number Of Laundry Hookups In All Units_63727', 'property.Multifamily Housing - Number Of Laundry Hookups In Common Area(s)_63729', 'property.Multifamily Housing - Number Of Residential Living Units In A High-Rise Building (10 Or More Stories)_63731', 'property.Multifamily Housing - Number Of Residential Living Units In A High-Rise Building Density (Number Per 1,000 Ft2)_63733', 'property.Multifamily Housing - Number Of Residential Living Units In A Low-Rise Building (1-4 Stories)_63735', 'property.Multifamily Housing - Number Of Residential Living Units In A Low-Rise Building Density (Number Per 1,000 Ft2)_63737', 'property.Multifamily Housing - Number Of Residential Living Units In A Mid-Rise Building (5-9 Stories)_63739', 'property.Multifamily Housing - Number Of Residential Living Units In A Mid-Rise Building Density (Number Per 1,000 Ft2)_63741', 'property.Multifamily Housing - Percent Of Gross Floor Area That Is Common Area(s)_63976', 'property.Multifamily Housing - Percent That Can Be Cooled_65231', 'property.Multifamily Housing - Percent That Can Be Heated_63745', 'property.Multifamily Housing - Primary Hot Water Fuel Type (for Units)_63978', 'property.Multifamily Housing - Resident Population Type_63747', 'property.Multifamily Housing - Total Number Of Residential Living Units Density (Number Per 1,000 Ft2)_63751', 'property.Multifamily Housing - Total Number Of Residential Living Units_63749', 'property.Municipally Supplied Potable Water - Mixed Indoor/Outdoor Use (kgal)_63663', 'property.Museum - Gross Floor Area (ft2)_65760', 'property.National Median Reference Property Type_63603', 'property.National Median Reference_64903', 'property.National Median Site Eui_63605', 'property.National Median Source Eui_63607', 'property.National Median Total GHG Emissions (Metric Tons CO2e)_63679', 'property.Natural Gas Use (kBtu)_63938', 'property.Net Emissions (Metric Tons CO2e)_63693', 'property.Non Time Weighted Floor Area_64771', 'property.Non-Refrigerated Warehouse - Gross Floor Area (ft2)_63885', 'property.Non-Refrigerated Warehouse - Number Of Walk-in Refrigeration/Freezer Units_64140', 'property.Non-Refrigerated Warehouse - Number Of Worker On Main Shift_64152', 'property.Non-Refrigerated Warehouse - Percent That Can Be Cooled_64142', 'property.Non-Refrigerated Warehouse - Percent That Can Be Heated_64144', 'property.Non-Refrigerated Warehouse - Walk-in Refrigeration Density (Number Per 1,000 Ft2)_64146', 'property.Non-Refrigerated Warehouse - Weekly Operating Hours_64148', 'property.Non-Refrigerated Warehouse - Worker Density (Number Per 1,000 Ft2)_64150', 'property.Occupancy_63598', 'property.Office - Computer Density (Number Per 1,000 Ft2)_63705', 'property.Office - Gross Floor Area (ft2)_63703', 'property.Office - Number Of Computers_63707', 'property.Office - Number Of Workers On Main Shift_63709', 'property.Office - Percent That Can Be Cooled_63711', 'property.Office - Percent That Can Be Heated_63713', 'property.Office - Weekly Operating Hours_63715', 'property.Office - Worker Density (Number Per 1,000 Ft2)_63717', 'property.Office Computer Density_65002', 'property.On Behalf Of_63923', 'property.Onsite Renewable System Electricty Exported_64931', 'property.Onsite Renewable System Generation_64929', 'property.Organization_63925', 'property.Other - Education - Gross Floor Area (ft2)_65762', 'property.Other - Entertainment/Public Assembly - Gross Floor Area (ft2)_63887', 'property.Other - Gross Floor Area (ft2)_63889', 'property.Other - Lodging/Residential - Gross Floor Area (ft2)_65764', 'property.Other - Mall - Gross Floor Area (ft2)_65766', 'property.Other - Public Services - Gross Floor Area (ft2)_65768', 'property.Other - Recreation - Gross Floor Area (ft2)_65770', 'property.Other - Restaurant/Bar - Gross Floor Area (ft2)_65772', 'property.Other - Services - Gross Floor Area (ft2)_65774', 'property.Other - Specialty Hospital - Gross Floor Area (ft2)_65776', 'property.Other - Stadium - Gross Floor Area (ft2)_65778', 'property.Other - Technology/Science - Gross Floor Area (ft2)_65780', 'property.Other - Utility - Gross Floor Area (ft2)_65782', 'property.Other Use (kBtu)_63946', 'property.Outdoor Water Use (All Water Sources) (kgal)_63661', 'property.Outpatient Rehabilitation/Physical Therapy - Gross Floor Area (ft2)_65784', 'property.Parking - Completely Enclosed Parking Garage Size (ft2)_63857', 'property.Parking - Gross Floor Area (ft2)_63933', 'property.Parking - Open Parking Lot Size (ft2)_63859', 'property.Parking - Partially Enclosed Parking Garage Size (ft2)_63861', 'property.Parking - Supplemental Heating_63863', 'property.Percent Better Than National Median Site Eui_64907', 'property.Percent Better Than National Median Source Eui_64909', 'property.Percent Of Electricity That Is Green Power_63687', 'property.Percent Of Total Electricity Generated From Onsite Renewable Systems_63685', 'property.Performing Arts - Gross Floor Area (ft2)_65786','property.Personal Services (Health/Beauty, Dry Cleaning, Etc.) - Gross Floor Area (ft2)_63891', 'property.Police Station - Gross Floor Area (ft2)_63913', 'property.Pre-school/Daycare - Gross Floor Area (ft2)_65788', 'property.Primary Property Type Epa Calculated_64780', 'property.Primary Property Type Self Selected_65226', 'property.Prison/Incarceration - Gross Floor Area (ft2)_65790', 'property.Propane Use (kBtu)_63649', 'property.Property Data Administrator - Email_63921', 'property.Property Data Administrator_63919', 'property.Property Floor Area Buildngs And Parking_64773', 'property.Property Floor Area Parking_63855', 'property.Property GFA - Calculated (Buildings And Parking) (ft2)_63466', 'property.Property GFA - Calculated (Parking) (ft2)_63470', 'property.Property GFA - Self-Reported (ft2)_63464', 'property.Property Name_65233', 'property.Property Notes_65236', 'property.Propertys Portfolio Manager Account Holder Email_65217', 'property.Propertys Portfolio Manager Account Holder_65215', 'property.Proprty Floor Area Buildings_64775', 'property.Race Track - Gross Floor Area (ft2)_65792', 'property.Refrigerated Warehouse - Gross Floor Area (ft2)_64132', 'property.Refrigerated Warehouse - Number Of Workers On Main Shift_64138', 'property.Refrigerated Warehouse - Weekly Operating Hours_64134', 'property.Refrigerated Warehouse - Worker Density (Number Per 1,000 Ft2)_64136', 'property.Repair Services (Vehicle, Shoe, Locksmith, Etc.) - Gross Floor Area (ft2)_65794', 'property.Residence Hall/ Dormitory - Computer Lab_64050', 'property.Residence Hall/ Dormitory - Dining Hall_64052', 'property.Residence Hall/Dormitory - Gross Floor Area (ft2)_63893', 'property.Residence Hall/Dormitory - Number Of Rooms_64054', 'property.Residence Hall/Dormitory - Percent That Can Be Cooled_64056', 'property.Residence Hall/Dormitory - Percent That Can Be Heated_64058', 'property.Restaurant - Gross Floor Area (ft2)_63895', 'property.Retail Store - Cash Register Density (Number Per 1,000 Ft2)_64060', 'property.Retail Store - Computer Density (Number Per 1,000 Ft2)_64074', 'property.Retail Store - Exterior Entrance To The Public_64062', 'property.Retail Store - Gross Floor Area (ft2)_63897', 'property.Retail Store - Number Of Cash Registers_64064', 'property.Retail Store - Number Of Computers_64068', 'property.Retail Store - Number Of Open Or Closed Refrigeration/Freezer Units_64066', 'property.Retail Store - Number Of Walk-in Refrigeration/Freezer Units_64070', 'property.Retail Store - Number Of Workers On Main Shift_64086', 'property.Retail Store - Open Or Closed Refrigeration Density (Number Per 1,000 Ft2)_64072', 'property.Retail Store - Percent That Can Be Cooled_64076', 'property.Retail Store - Percent That Can Be Heated_64078', 'property.Retail Store - Walk-in Refrigeration Density (Number Per 1,000 Ft2)_64080', 'property.Retail Store - Weekly Operating Hours_64082', 'property.Retail Store - Worker Density (Number Per 1,000 Ft2)_64084', 'property.Roller Rink - Gross Floor Area (ft2)_65796', 'property.Second Largest Property Use Type - Gross Floor Area (ft2)_65227', 'property.Second Largest Property Use Type Gfa_64789', 'property.Second Largest Property Use Type_64787', 'property.Self-Storage Facility - Gross Floor Area (ft2)_63899', 'property.Senior Care Community - Average Number Of Residents_64088', 'property.Senior Care Community - Gross Floor Area (ft2)_64090', 'property.Senior Care Community - Maximum Resident Capacity_64108', 'property.Senior Care Community - Number Of Commercial Refrigeration/ Freezer Units_64092', 'property.Senior Care Community - Number Of Commercial Washing Machines_64094', 'property.Senior Care Community - Number Of Computers_64096', 'property.Senior Care Community - Number Of Residential Electronic Lift Systems_64098', 'property.Senior Care Community - Number Of Residential Washing Machines_64100', 'property.Senior Care Community - Number Of Workers On Main Shift_64110', 'property.Senior Care Community - Percent That Can Be Cooled_64102', 'property.Senior Care Community - Percent That Can Be Heated_64104', 'property.Senior Care Community - Total Number Of Residential Living Units_64106', 'property.Service And Product Provider_63917', 'property.Single Family Home - Gross Floor Area (ft2)_65798', 'property.Site Energy Use (kBtu)_63613', 'property.Social/Meeting Hall - Gross Floor Area (ft2)_65800', 'property.Source Energy Use (kBtu)_63615', 'property.Stadium (Closed) - Gross Floor Area (ft2)_65802', 'property.Stadium (Open) - Gross Floor Area (ft2)_65804', 'property.State Province_65225', 'property.Strip Mall - Gross Floor Area (ft2)_65806', 'property.Supermarket/Grocery - Cooking Facilities_64122', 'property.Supermarket/Grocery - Gross Floor Area (ft2)_63901', 'property.Supermarket/Grocery - Number Of Cash Registers_64114', 'property.Supermarket/Grocery - Number Of Open Or Closed Refrigeration/Freezer Units_64112', 'property.Supermarket/Grocery - Number Of Walk-in Refrigeration/Freezer Units_64116', 'property.Supermarket/Grocery - Number Of Workers On Main Shift_64130', 'property.Supermarket/Grocery - Percent That Can Be Cooled_64118', 'property.Supermarket/Grocery - Percent That Can Be Heated_64120', 'property.Supermarket/Grocery - Walk-in Refrigeration Density (Number Per 1,000 Ft2)_64124', 'property.Supermarket/Grocery - Weekly Operating Hours_64126', 'property.Supermarket/Grocery - Worker Density (Number Per 1,000 Ft2)_64128', 'property.Swimming Pool - Approximate Pool Size_63903', 'property.Swimming Pool - Location Of Pool_63905', 'property.Swimming Pool - Months In Use_63907', 'property.Temporary Values_63569', 'property.Third Largest Property Use Type - Gross Floor Area (ft2)_65228', 'property.Third Largest Property Use Type Gfa_64793', 'property.Third Largest Property Use Type_64791', 'property.Third Party Certification_63932', 'property.Total Waste (Disposed And Diverted) (Tons)_63665', 'property.Total Waste (Disposed And Diverted) - Intensity (lbs/ft2)_63667', 'property.Transportation Terminal/Station - Gross Floor Area (ft2)_65808', 'property.Urgent Care/Clinic/Other Outpatient - Gross Floor Area (ft2)_65810', 'property.Veterinary Office - Gross Floor Area (ft2)_65812', 'property.Vocational School - Gross Floor Area (ft2)_65814', 'property.Wastewater Treatment Plant - Gross Floor Area (ft2)_63909', 'property.Water Alerts_63970', 'property.Water Current Date_63509', 'property.Water Intensity Total_64804', 'property.Water Use Intensity (All Water Sources) (gal/ft2)_63499', 'property.Weather Normalized Site Electricity (kWh)_63621', 'property.Weather Normalized Site Energy Use (kBtu)_63617', 'property.Weather Normalized Site Energy Use_65230', 'property.Weather Normalized Site Natural Gas Use (therms)_63623', 'property.Weather Normalized Source Energy Use (kBtu)_63619', 'property.Wholesale Club/Supercenter- Gross Floor Area (ft2)_65816', 'property.Wood Use (kBtu)_63948', 'property.Worship Facility - Commercial Refrigeration Density (Number Per 1,000 Ft2)_64030', 'property.Worship Facility - Computer Density (Number Per 1,000 Ft2)_64036', 'property.Worship Facility - Cooking Facilities_64038', 'property.Worship Facility - Gross Floor Area (ft2)_63915', 'property.Worship Facility - Number Of Commercial Refrigeration/Freezer Units_64032', 'property.Worship Facility - Number Of Computers_64034', 'property.Worship Facility - Weekly Operating Hours_64040', 'property.address_line_1_63311', 'property.address_line_2_63313', 'property.analysis_end_time_63362', 'property.analysis_start_time_63361', 'property.analysis_state_63363', 'property.analysis_state_message_63364', 'property.bounding_box', 'property.building_certification_63360', 'property.building_count_63341', 'property.campus_63327', 'property.centroid', 'property.city_63315', 'property.conditioned_floor_area_63344', 'property.created_63329', 'property.custom_id_1_63309', 'property.energy_alerts_63358', 'property.generation_date_63350', 'property.geocoding_confidence_67164', 'property.gross_floor_area_63332', 'property.home_energy_score_id_63349', 'property.id', 'property.jurisdiction_property_id_63307', 'property.latitude_63325', 'property.long_lat', 'property.longitude_63326', 'property.lot_number_63323', 'property.notes_count', 'property.occupied_floor_area_63345', 'property.owner_63338', 'property.owner_address_63346', 'property.owner_city_state_63347', 'property.owner_email_63339', 'property.owner_postal_code_63348', 'property.owner_telephone_63340', 'property.postal_code_63321', 'property.property_footprint_67396', 'property.property_state_id', 'property.property_type_63336', 'property.property_view_id', 'property.recent_sale_date_63343', 'property.release_date_63351', 'property.site_eui_modeled_63354', 'property.source_eui_modeled_63357', 'property.space_alerts_63359', 'property.state_63317', 'property.ubid_63308', 'property.updated_63328', 'property.use_description_63333', 'property.year_built_63342'], inplace= True)
		#Renames/reformats all relevant columns


		data_View4['Merge ID - 1'] = data_View4['REPORTINGYEAR'].apply(str) + '-' + (data_View4['jurisdiction_tax_lot_id_63306'])
		data_View4['Merge ID - 2'] = data_View4['REPORTINGYEAR'].apply(str) + '-' + (data_View4['property.pm_property_id_63304'])
		data_View4['Merge ID - 2'] = np.where(data_View4['property.pm_property_id_63304'] == '', data_View4['REPORTINGYEAR'].apply(str) + '-' + data_View4['jurisdiction_tax_lot_id_63306'],data_View4['Merge ID - 2'])

		
		for item in data_View4['property.pm_property_id_63304']:
			if item != None :	
				data_View4['PID'] = 'PM' + data_View4['property.pm_property_id_63304']
			
		data_View4['PID'] = np.where(data_View4['property.pm_property_id_63304'] == '', 'DC' + data_View4['jurisdiction_tax_lot_id_63306'].str.replace('-',''),data_View4['PID'])
		data_View4.rename(columns={'property.District Steam Use (kBtu)_63651':'DISTRSTEAM_KBTU','property.District Chilled Water Use (kBtu)_63655':'DISTRCHILLEDWATER_KBTU','property.District Hot Water Use (kBtu)_63653': 'DISTRHOTWATER_KBTU','property.Electricity Use - Generated From Onsite Renewable Systems And Used Onsite (kWh)_63629': 'ELECTRICITYUSE_RENEWABLE_KWH','property.Water Score (Multifamily Only)_63501': 'WATERSCORE_MFPROPERTIES', 'jurisdiction_tax_lot_id_63306' : 'DCREALPROPERTYID','property.pm_property_id_63304' : 'PMPROPERTYID','property.property_name_63324' : 'PROPERTYNAME','property.pm_parent_property_id_63305' : 'PMPARENTPROPERTYID','property.Parent Property Name_63444' : 'PARENTPROPERTYNAME','Compliance Status' : 'REPORTSTATUS','address_line_1_63312' : 'ADDRESSOFRECORD','OWNERNAME_63370' : 'OWNEROFRECORD','WARD_63378' : 'WARD','property.Address line 1 - custom_67813' : 'REPORTEDADDRESS','city_63316' : 'CITY','state_63318' : 'STATE','postal_code_63322' : 'POSTALCODE','Year Built_63383' : 'YEARBUILT','property.Primary Property Type - Self Selected_63472' : 'PRIMARYPROPERTYTYPE_SELFSELECT','property.Primary Property Type - Portfolio Manager-Calculated_65237' : 'PRIMARYPROPERTYTYPE_EPACALC','SumOfGBA_63380' : 'TAXRECORDFLOORAREA','property.Property GFA - Calculated (Buildings) (ft2)_63468' : 'REPORTEDBUILDINGGROSSFLOORAREA','property.energy_score_63334' : 'ENERGYSTARSCORE','property.site_eui_63352' : 'SITEEUI_KBTU_FT','property.site_eui_weather_normalized_63353' : 'WEATHERNORMALZEDSITEEUI_KBTUFT','property.source_eui_63355' : 'SOURCEEUI_KBTU_FT','property.source_eui_weather_normalized_63356' : 'WEATHERNORMALZEDSOURCEEUI_KBTUFT','property.Total GHG Emissions (Metric Tons CO2e)_63671' : 'TOTGHGEMISSIONS_METRICTONSCO2E','property.Total GHG Emissions Intensity (kgCO2e/ft2)_63673' : 'TOTGHGEMISSINTENSITY_KGCO2EFT','property.Water Use (All Water Sources) (kgal)_63495' : 'WATERUSE_ALLWATERSOURCES_KGAL','property.Electricity Use - Grid Purchase (kWh)_63627' : 'ELECTRICITYUSE_GRID_KWH','property.Natural Gas Use (therms)_63635' : 'NATURALGASUSE_THERMS','property.fuel_use' : 'FUELOILANDDIESELFUELUSEKBTU', 'property.Elec - Jan_65690': 'ELECTRICITYUSE_KBTU_JANUARY', 'property.Elec - Feb_65688': 'ELECTRICITYUSE_KBTU_FEBRUARY', 'property.Elec - March_65686': 'ELECTRICITYUSE_KBTU_MARCH',  'property.Elec - Apr_65684': 'ELECTRICITYUSE_KBTU_APRIL', 'property.Elec - May_65682': 'ELECTRICITYUSE_KBTU_MAY', 'property.Elec - June_65680': 'ELECTRICITYUSE_KBTU_JUNE', 'property.Elec - July_65678': 'ELECTRICITYUSE_KBTU_JULY', 'property.Elec - Aug_65676': 'ELECTRICITYUSE_KBTU_AUGUST', 'property.Elec - Sept_65674': 'ELECTRICITYUSE_KBTU_SEPTEMBER', 'property.Elec - Oct_65672': 'ELECTRICITYUSE_KBTU_OCTOBER', 'property.Elec - Nov_65670': 'ELECTRICITYUSE_KBTU_NOVEMBER',  'property.Elec - Dec_65668': 'ELECTRICITYUSE_KBTU_DECEMBER', 'property.NG - Jan_65714': 'NATURALGAS_KBTU_JANUARY' , 'property.NG - Feb_65712': 'NATURALGAS_KBTU_FEBRUARY', 'property.NG - March_65710': 'NATURALGAS_KBTU_MARCH', 'property.NG - Apr_65708': 'NATURALGAS_KBTU_APRIL', 'property.NG - May_65706': 'NATURALGAS_KBTU_MAY', 'property.NG - June_65704': 'NATURALGAS_KBTU_JUNE',  'property.NG - July_65702': 'NATURALGAS_KBTU_JULY', 'property.NG - Aug_65700': 'NATURALGAS_KBTU_AUGUST', 'property.NG - Sept_65698': 'NATURALGAS_KBTU_SEPTEMBER', 'property.NG - Oct_65696': 'NATURALGAS_KBTU_OCTOBER', 'property.NG - Nov_65694': 'NATURALGAS_KBTU_NOVEMBER', 'property.NG - Dec_65692': 'NATURALGAS_KBTU_DECEMBER', 'property.Metered Areas  (Water)_63505' : 'METEREDAREAS_WATER','property.Metered Areas (Energy)_63503' : 'METEREDAREAS_ENERGY','property.property_notes_63335' : 'OWNERPROVIDEDPUBLICNOTES','LatX_63409' : 'X', 'LongY_63411' : 'Y','updated_63330':'LASTUPDATE'}, inplace= True)
		data_View4['DCREALPROPERTYID'] = data_View4['DCREALPROPERTYID'].str.replace('-','_')
		data_View4['ENERGYSTARSCORE'] = data_View4['ENERGYSTARSCORE'].replace(0, np.nan)
		data_View4.drop(data_View4[(data_View4['PMPROPERTYID'] == '')&(data_View4['TAXRECORDFLOORAREA'] <50000)].index, inplace= True)
		


		data_View4.set_index('DCREALPROPERTYID',inplace = True)
		data_View4.to_excel('CSV output\\Disclosure_'+str(reporting_year)+'_'+tstamp+'.xlsx')
		print (reporting_year)
		
		
	except:
		SEEDClient.orgID = SEEDorgID
		sleep(5)
		data_View = json.loads(SEEDClient.get_taxlot_list(SEEDcycleID).text)
		data_View2 = pd.json_normalize(data_View['results'])
		#data_View2.to_excel('CSV output\\temp'+tstamp +'.xlsx')

		data_View3 = pd.json_normalize(data_View['results'],record_path='related',meta = 'taxlot_view_id',record_prefix = 'property.')
		data_View4 = pd.merge(data_View2, data_View3, how='left',on='taxlot_view_id') 
		data_View4.drop(columns=['related'], inplace = True)
		

		## Applies Status
		data_View4['Compliance Status'] = data_View4.apply(status,axis = 1)
		data_View4['property.Period Ending Date_64755'] = pd.to_datetime(data_View4['property.Period Ending Date_64755'], errors='coerce', format='%m/%d/%Y')

		data_View4['Year Built_63383'] = data_View4['Year Built_63383'].fillna(	data_View4['property.year_built_63342'])
		data_View4['Year Built_63383'] = pd.to_datetime(data_View4['Year Built_63383'], errors='coerce', format='%Y').dt.year

		data_View4.loc[(data_View4['Year Built_63383'] >= data_View4['property.Period Ending Date_64755'].dt.year - 1), 'Compliance Status'] = "Exempt from this year's disclosure"
		data_View4['property.pm_property_id_63304'] = data_View4['property.pm_property_id_63304'].fillna('')
		data_View4['Compliance Status'] = np.where((data_View4['property.pm_property_id_63304'] != '')& (data_View4['Compliance Status'] == 'No Report Received'), 'Data Under Review by DOEE',data_View4['Compliance Status'])

		#Converts string to numbers 
		data_View4['property.Occupancy_63598'] = pd.to_numeric(data_View4['property.Occupancy_63598']).fillna(0)
		data_View4['property.Fuel Oil #1 Use (kBtu)_63637'] = pd.to_numeric(data_View4['property.Fuel Oil #1 Use (kBtu)_63637']).fillna(0)
		data_View4['property.Fuel Oil #2 Use (kBtu)_63639'] = pd.to_numeric(data_View4['property.Fuel Oil #2 Use (kBtu)_63639']).fillna(0)
		data_View4['property.Fuel Oil #4 Use (kBtu)_63641'] = pd.to_numeric(data_View4['property.Fuel Oil #4 Use (kBtu)_63641']).fillna(0)
		data_View4['property.Fuel Oil #5 & 6 Use (kBtu)_63643'] = pd.to_numeric(data_View4['property.Fuel Oil #5 & 6 Use (kBtu)_63643']).fillna(0)
		data_View4['property.Diesel #2 Use (kBtu)_63645'] = pd.to_numeric(data_View4['property.Diesel #2 Use (kBtu)_63645']).fillna(0)
		data_View4['property.Propane Use (kBtu)_63649'] = pd.to_numeric(data_View4['property.Propane Use (kBtu)_63649']).fillna(0)
		data_View4['property.District Steam Use (kBtu)_63651'] = pd.to_numeric(data_View4['property.District Steam Use (kBtu)_63651']).fillna(0)
		data_View4['property.District Chilled Water Use (kBtu)_63655'] = pd.to_numeric(data_View4['property.District Chilled Water Use (kBtu)_63655']).fillna(0)
		data_View4['property.District Hot Water Use (kBtu)_63653'] = pd.to_numeric(data_View4['property.District Hot Water Use (kBtu)_63653']).fillna(0)
		data_View4['property.Electricity Use - Generated From Onsite Renewable Systems And Used Onsite (kWh)_63629'] = pd.to_numeric(data_View4['property.Electricity Use - Generated From Onsite Renewable Systems And Used Onsite (kWh)_63629']).fillna(0)
		data_View4['property.Water Score (Multifamily Only)_63501'] = data_View4['property.Water Score (Multifamily Only)_63501'].fillna('')
		data_View4['property.pm_parent_property_id_63305'] = data_View4['property.pm_parent_property_id_63305'].fillna('')
		data_View4['property.pm_parent_property_id_63305'] = data_View4['property.pm_parent_property_id_63305'].replace('Not Applicable: Standalone Property','')
		data_View4['property.Parent Property Name_63444'] = data_View4['property.Parent Property Name_63444'].fillna('')
		data_View4['property.Parent Property Name_63444'] = data_View4['property.Parent Property Name_63444'].replace('Not Applicable: Standalone Property','')
		
		data_View4['property.Property GFA - Calculated (Buildings) (ft2)_63468'] = pd.to_numeric(data_View4['property.Property GFA - Calculated (Buildings) (ft2)_63468']).fillna(0)
		data_View4['property.energy_score_63334'] = pd.to_numeric(data_View4['property.energy_score_63334']).fillna(0)
		data_View4['property.site_eui_63352'] = pd.to_numeric(data_View4['property.site_eui_63352']).fillna(0)
		data_View4['property.site_eui_weather_normalized_63353'] = pd.to_numeric(data_View4['property.site_eui_weather_normalized_63353']).fillna(0)
		data_View4['property.source_eui_63355'] = pd.to_numeric(data_View4['property.source_eui_63355']).fillna(0)
		data_View4['property.source_eui_weather_normalized_63356'] = pd.to_numeric(data_View4['property.source_eui_weather_normalized_63356']).fillna(0)
		data_View4['property.Total GHG Emissions (Metric Tons CO2e)_63671'] = pd.to_numeric(data_View4['property.Total GHG Emissions (Metric Tons CO2e)_63671']).fillna(0)
		data_View4['property.Total GHG Emissions Intensity (kgCO2e/ft2)_63673'] = pd.to_numeric(data_View4['property.Total GHG Emissions Intensity (kgCO2e/ft2)_63673']).fillna(0)
		data_View4['property.Water Use (All Water Sources) (kgal)_63495'] = pd.to_numeric(data_View4['property.Water Use (All Water Sources) (kgal)_63495']).fillna(0)
		data_View4['property.Electricity Use - Grid Purchase (kWh)_63627'] = pd.to_numeric(data_View4['property.Electricity Use - Grid Purchase (kWh)_63627']).fillna(0)
		data_View4['property.Natural Gas Use (therms)_63635'] = pd.to_numeric(data_View4['property.Natural Gas Use (therms)_63635']).fillna(0)
		data_View4['property.Elec - Jan_65690'] = pd.to_numeric(data_View4['property.Elec - Jan_65690']).fillna(0)
		data_View4['property.Elec - Feb_65688'] = pd.to_numeric(data_View4['property.Elec - Feb_65688']).fillna(0)
		data_View4['property.Elec - March_65686'] = pd.to_numeric(data_View4['property.Elec - March_65686']).fillna(0)
		data_View4['property.Elec - Apr_65684'] = pd.to_numeric(data_View4['property.Elec - Apr_65684']).fillna(0)
		data_View4['property.Elec - May_65682'] = pd.to_numeric(data_View4['property.Elec - May_65682']).fillna(0)
		data_View4['property.Elec - June_65680'] = pd.to_numeric(data_View4['property.Elec - June_65680']).fillna(0)
		data_View4['property.Elec - July_65678'] = pd.to_numeric(data_View4['property.Elec - July_65678']).fillna(0)
		data_View4['property.Elec - Aug_65676'] = pd.to_numeric(data_View4['property.Elec - Aug_65676']).fillna(0)
		data_View4['property.Elec - Sept_65674'] = pd.to_numeric(data_View4['property.Elec - Sept_65674']).fillna(0)
		data_View4['property.Elec - Oct_65672'] = pd.to_numeric(data_View4['property.Elec - Oct_65672']).fillna(0)
		data_View4['property.Elec - Nov_65670'] = pd.to_numeric(data_View4['property.Elec - Nov_65670']).fillna(0)
		data_View4['property.Elec - Dec_65668'] = pd.to_numeric(data_View4['property.Elec - Dec_65668']).fillna(0)
		data_View4['property.NG - Jan_65714'] = pd.to_numeric(data_View4['property.NG - Jan_65714']).fillna(0)
		data_View4['property.NG - Feb_65712'] = pd.to_numeric(data_View4['property.NG - Feb_65712']).fillna(0)
		data_View4['property.NG - March_65710'] = pd.to_numeric(data_View4['property.NG - March_65710']).fillna(0)
		data_View4['property.NG - Apr_65708'] = pd.to_numeric(data_View4['property.NG - Apr_65708']).fillna(0)
		data_View4['property.NG - May_65706'] = pd.to_numeric(data_View4['property.NG - May_65706']).fillna(0)
		data_View4['property.NG - June_65704'] = pd.to_numeric(data_View4['property.NG - June_65704']).fillna(0)
		data_View4['property.NG - July_65702'] = pd.to_numeric(data_View4['property.NG - July_65702']).fillna(0)
		data_View4['property.NG - Aug_65700'] = pd.to_numeric(data_View4['property.NG - Aug_65700']).fillna(0)
		data_View4['property.NG - Sept_65698'] = pd.to_numeric(data_View4['property.NG - Sept_65698']).fillna(0)
		data_View4['property.NG - Oct_65696'] = pd.to_numeric(data_View4['property.NG - Oct_65696']).fillna(0)
		data_View4['property.NG - Nov_65694'] = pd.to_numeric(data_View4['property.NG - Nov_65694']).fillna(0)
		data_View4['property.NG - Dec_65692'] = pd.to_numeric(data_View4['property.NG - Dec_65692']).fillna(0) 
		data_View4['SumOfGBA_63380'] = pd.to_numeric(data_View4['SumOfGBA_63380']).fillna(0) 
		data_View4['updated_63330'] = data_View4['property.updated_63328'].str.replace("(T).*","")
	

		
		"""
		data_View4['property.District Chilled Water Use (kBtu)_63655'] = pd.to_numeric(data_View4['property.District Chilled Water Use (kBtu)_63655']).fillna(0)
		data_View4['property.District Hot Water Use (kBtu)_63653'] = pd.to_numeric(data_View4['property.District Hot Water Use (kBtu)_63653']).fillna(0)
		data_View4['property.District Steam Use (kBtu)_63651'] = pd.to_numeric(data_View4['property.District Steam Use (kBtu)_63651']).fillna(0)
		"""
		#Applies Filters and sums fields
		data_View4.loc[(data_View4['property.Occupancy_63598'] < 50) & (data_View4['property.Primary Property Type - Portfolio Manager-Calculated_65237'] == 'Multifamily Housing') & (data_View4['property.energy_score_63334'] >= 95), 'property.energy_score_63334'] = ''
		data_View4['property.fuel_use'] = data_View4.fillna(0)['property.Fuel Oil #1 Use (kBtu)_63637'] + data_View4.fillna(0)['property.Fuel Oil #2 Use (kBtu)_63639'] + data_View4.fillna(0)['property.Fuel Oil #4 Use (kBtu)_63641'] + data_View4.fillna(0)['property.Fuel Oil #5 & 6 Use (kBtu)_63643'] + data_View4.fillna(0)['property.Diesel #2 Use (kBtu)_63645'] + data_View4.fillna(0)['property.Propane Use (kBtu)_63649']
		data_View4['property.district_water_use'] = data_View4['property.District Chilled Water Use (kBtu)_63655'] + data_View4['property.District Hot Water Use (kBtu)_63653'] + data_View4['property.District Steam Use (kBtu)_63651']
		#data_View4['property.fuel_use'] = data_View4['property.fuel_use'].replace(0, '')
		#data_View4['property.district_water_use'] = data_View4['property.district_water_use'].replace(0, '')
		data_View4['REPORTINGYEAR'] = reporting_year
		#data_View4.to_excel('CSV output\\temp_'+tstamp +'.xlsx')


		#Clear fields for exmept reports and drop duplicate reports
		property_data_cols = [col for col in data_View4.columns if col.startswith('property.')]
		data_View4.loc[data_View4['Compliance Status'] == "Exempt from this year's disclosure", property_data_cols] = ''
		data_View4.loc[data_View4['Compliance Status'] == "No Report Received", property_data_cols] = ''
		data_View4.drop(data_View4[data_View4['Compliance Status'] == 'Delete this report'].index, inplace= True)
		data_View4.drop(columns = ['REGISTERED AGENT EMAIL_76069','property.Data Quality Checker Run_74123', 'property.Jurisdiction Tax Lot ID_72377', 'property.Alert - Energy - No meters selected for metrics_74082','SECOND OWNER CITY_72396','SECOND OWNER ZIP_72400', 'Public Building_74121', 'TAX ADDRESS_76068', 'Table_origin (Invalid Footprint)_74170','SECOND OWNER ADDRESS 2_72394', 'SECOND OWNER ADDRESS 1_72392','SECOND OWNER STATE_72398', 'SECOND OWNERNAME_72402','property.district_water_use', 'property.Electricity Use - Grid Purchase And Generated From Onsite Renewable Systems (kWh)_63625','property.Estimated Data Flag - Data Center IT Equipment Input Meter_71242','property.Estimated Data Flag - Data Center PDU Input Meter_71240','property.Estimated Data Flag - Data Center PDU Output Meter_71241','property.Estimated Data Flag - Data Center UPS Output Meter_71239','property.Estimated Data Flag - Municipally Supplied Potable Water - Indoor Use_71235','property.Estimated Data Flag - Municipally Supplied Potable Water - Outdoor Use_71236','property.Estimated Data Flag - Municipally Supplied Reclaimed Water - Indoor Use_71237','property.Estimated Data Flag - Municipally Supplied Reclaimed Water - Outdoor Use_71238','property.Hotel - Gym/fitness Center Floor Area (ft2)_71243','property.Metered Areas (Water)_71234','property.Property Use Detail Alerts_71288','property.Weather Station Name_71289','property.Zoo - Gross Floor Area (ft2)_71291','property.Estimated Data Flag - Data Center IT Equipment Input Meter_71242','property.ENERGY STAR Certification - Application Status_71290','property.Water Score_64806', 'property.Period Ending Date_64755', 'address_line_2_63314','taxlot_view_id','CAREOFNAME_63372','DC Real Property ID_66748', 'Exempt 2011 Reporting (2010 Data)_63435', 'property.year_ending_63337', 'Exempt 2012 Reporting (2011 Data)_63433', 'Exempt 2013 Reporting (2012 Data)_63431', 'Exempt 2014 Reporting (2013 Data)_63429', 'Exempt 2015 Reporting (2014 Data)_63427', 'Exempt 2016 Reporting (2015 Data)_63425', 'Exempt 2017 Reporting (2016 Data)_63423', 'Exempt 2018 Reporting (2017 Data)_63421', 'Exempt 2019 Reporting (2018 Data)_63419', 'Exempt 2020 Reporting (2019 Data)_63417', 'ExemptTotally_63415', 'Exemption Reason_63437', 'Foreign_63413', 'Jurisdiction Tax Lot ID_65232', 'OWNER ADDRESS 1_63387', 'OWNER ADDRESS 2_63389', 'OWNER CITY_63391', 'OWNER STATE_63393', 'OWNER ZIP_63395', 'REGISTERED AGENT ADDRESS 2_66758', 'REGISTERED AGENT ADDRESS_63399', 'REGISTERED AGENT CITY_63401', 'REGISTERED AGENT NAME_63397', 'REGISTERED AGENT STATE_63403', 'REGISTERED AGENT ZIP_63405', 'Recent Sale Date_63385', 'USE_SDESC_63407', 'block_number_63366', 'bounding_box', 'created_63331', 'custom_id_1_63310', 'district_63367', 'geocoding_confidence_67165', 'id', 'latitude_67669', 'long_lat', 'longitude_67670', 'notes_count', 'number_properties_63365', 'taxlot_footprint_67397', 'taxlot_state_id', 'ulid_67395', 'property.% Difference From National Median Site EUI_63609', 'property.% Difference From National Median Source EUI_63611', 'property.2nd Largest Property Use - Gross Floor Area (ft2)_63484', 'property.2nd Largest Property Use Type_63482', 'property.3rd Largest Property Use Type - Gross Floor Area (ft2)_63488', 'property.3rd Largest Property Use Type_63486', 'property.Adult Education - Gross Floor Area (ft2)_65718', 'property.Alert - Data Center Issue (with Estimates, IT Configuration, Or IT Meter)_63577', 'property.Alert - Energy - No Meters Selected For Metrics_63585', 'property.Alert - Energy Meter Has Gaps_63581', 'property.Alert - Energy Meter Has Less Than 12 Full Calendar Months Of Data_63579', 'property.Alert - Energy Meter Has Overlaps_63583', 'property.Alert - Energy Meter Has Single Entry More Than 65 Days_63587', 'property.Alert - Gross Floor Area Is 0 Ft2_63573', 'property.Alert - No Meters Are Associated With This Property_65242', 'property.Alert - Property Has No Uses_63575', 'property.Alert - Water - No Meters Selected For Metrics_63595', 'property.Alert - Water Meter Has Gaps_63591', 'property.Alert - Water Meter Has Less Than 12 Full Calendar Months Of Data_63589', 'property.Alert - Water Meter Has Overlaps_63593', 'property.Alternative Water Generated On Site - Mixed Indoor/Outdoor Use (kgal)_65244', 'property.Ambulatory Surgical Center - Gross Floor Area (ft2)_65720', 'property.Aquarium - Gross Floor Area (ft2)_65722', 'property.Automobile Dealership - Gross Floor Area (ft2)_65724', 'property.Avoided Emissions - Offsite Green Power (Metric Tons CO2e)_63691', 'property.Avoided Emissions - Onsite Green Power (Metric Tons CO2e)_63689', 'property.Bank Branch - Computer Density (Number Per 1,000 Ft2)_63986', 'property.Bank Branch - Gross Floor Area (ft2)_63865', 'property.Bank Branch - Number Of Computers_63980', 'property.Bank Branch - Number Of Workers On Main Shift_63992', 'property.Bank Branch - Percent That Can Be Cooled_63982', 'property.Bank Branch - Percent That Can Be Heated_63984', 'property.Bank Branch - Weekly Operating Hours_63988', 'property.Bank Branch - Worker Density (Number Per 1,000 Ft2)_63990', 'property.Bar/Nightclub - Gross Floor Area (ft2)_65726', 'property.Barracks- Gross Floor Area (ft2)_65728', 'property.Bowling Alley - Gross Floor Area (ft2)_65730', 'property.Casino - Gross Floor Area (ft2)_65732', 'property.CoStar Property ID_64224', 'property.Coal - Anthracite Use (kBtu)_63940', 'property.Coal - Bituminous Use (kBtu)_63942', 'property.Coke Use (kBtu)_63944', 'property.College/University - Gross Floor Area (ft2)_63867', 'property.Construction Status_63600', 'property.Convenience Store With Gas Station - Gross Floor Area (ft2)_65734', 'property.Convenience Store Without Gas Station - Gross Floor Area (ft2)_63869', 'property.Convention Center - Gross Floor Area (ft2)_65736', 'property.Courthouse - Computer Density (Number Per 1,000 Ft2)_64000', 'property.Courthouse - Gross Floor Area (ft2)_63871', 'property.Courthouse - Number Of Computers_63994', 'property.Courthouse - Number Of Workers On Main Shift_64006', 'property.Courthouse - Percent That Can Be Cooled_63996', 'property.Courthouse - Percent That Can Be Heated_63998', 'property.Courthouse - Weekly Operating Hours_64002', 'property.Courthouse - Worker Density (Number Per 1,000 Ft2)_64004', 'property.Custom Property ID 1 - ID_65235', 'property.Custom Property Id 1 Id_64766', 'property.DC Real Property ID_63931', 'property.Data Center - Cooling Equipment Redundancy_63755', 'property.Data Center - Energy Estimates Applied_63757', 'property.Data Center - Gross Floor Area (ft2)_63753', 'property.Data Center - IT Energy Configuration_63759', 'property.Data Center - IT Equipment Input Meter (kWh)_63769', 'property.Data Center - IT Site Energy (kWh)_63771', 'property.Data Center - IT Source Energy (kBtu)_64010', 'property.Data Center - National Median PUE_64012', 'property.Data Center - PDU Input Meter (kWh)_63765', 'property.Data Center - PDU Output Meter (kWh)_63767', 'property.Data Center - PUE_64008', 'property.Data Center - UPS Output Meter (kWh)_63763', 'property.Data Center - UPS System Redundancy_63761', 'property.Data Quality Checker - Date Run_63571', 'property.Data Quality Checker Run?_64230', 'property.Default Data Flag - Multifamily_65716', 'property.Default Values_63527', 'property.Diesel #2 Use (kBtu)_63645', 'property.Direct GHG Emissions (Metric Tons CO2e)_63675', 'property.District Of Columbia Building Unique ID_63457', 'property.District Of Columbia Building Unique Id_64764', 'property.District Of Columbia Real Property Unique ID - Additional Web Services_65660', 'property.District Of Columbia Real Property Unique ID - Web Services_65658', 'property.District Of Columbia Real Property Unique ID_65234', 'property.District Of Columbia Real Property Unique Id_64762', 'property.Diversion Rate (%)_63669', 'property.Drinking Water Treatment & Distribution - Gross Floor Area (ft2)_65738', 'property.EGRID Output Emissions Rate (kgCO2e/MBtu)_63934', 'property.ENERGY STAR Certification - Eligibility_63701', 'property.ENERGY STAR Certification - Last Approval Date_63697', 'property.ENERGY STAR Certification - Next Eligible Date_63699', 'property.ENERGY STAR Certification - Profile Published_65247', 'property.ENERGY STAR Certification - Year(s) Certified_63695', 'property.Electricity Use - Generated From Onsite Renewable Systems (kWh)_63631', 'property.Electricity Use - Generated From Onsite Renewable Systems And Exported (kWh)_63633', 'property.Electricity Use - Grid Purchase (kBtu)_63936', 'property.Electricity Use - Grid Purchase And Generated From Onsite Renewable Systems (kBtu)_65823', 'property.Enclosed Mall - Gross Floor Area (ft2)_65740', 'property.Energy Current Date_63507', 'property.Energy/Power Station - Gross Floor Area (ft2)_65742', 'property.Estimated Data Flag -  Data Center IT Equipment Input Meter_63567', 'property.Estimated Data Flag -  Data Center PDU Input Meter_63563', 'property.Estimated Data Flag -  Data Center PDU Output Meter_63565', 'property.Estimated Data Flag -  Data Center UPS Output Meter_63561', 'property.Estimated Data Flag -  Municipally Supplied Potable Water - Indoor Use_63549', 'property.Estimated Data Flag -  Municipally Supplied Potable Water - Outdoor Use_65229', 'property.Estimated Data Flag -  Municipally Supplied Reclaimed Water - Indoor Use_63555', 'property.Estimated Data Flag -  Municipally Supplied Reclaimed Water - Outdoor Use_63557', 'property.Estimated Data Flag - Coal (anthracite)_63950', 'property.Estimated Data Flag - Coal (bitumiNous)_63952', 'property.Estimated Data Flag - Coke_63954', 'property.Estimated Data Flag - Diesel_63956', 'property.Estimated Data Flag - District Chilled Water_63547', 'property.Estimated Data Flag - District Hot Water_63545', 'property.Estimated Data Flag - District Steam_63543', 'property.Estimated Data Flag - Electricity (Grid Purchase)_63533', 'property.Estimated Data Flag - Electricity (Onsite Solar)_63535', 'property.Estimated Data Flag - Fuel Oil (No. 1)_63539', 'property.Estimated Data Flag - Fuel Oil (No. 2)_63541', 'property.Estimated Data Flag - Fuel Oil (No. 4)_63958', 'property.Estimated Data Flag - Fuel Oil (No. 5 And No. 6)_63960', 'property.Estimated Data Flag - Kerosene_63962', 'property.Estimated Data Flag - Municipally Supplied Potable Water: Mixed Indoor/Outdoor Use_63553', 'property.Estimated Data Flag - Municipally Supplied Reclaimed Water: Mixed Indoor/Outdoor Use_63559', 'property.Estimated Data Flag - Natural Gas_63537', 'property.Estimated Data Flag - Other_63964', 'property.Estimated Data Flag - Propane_63966', 'property.Estimated Data Flag - Wood_63968', 'property.Estimated Data Flag Municipally Supplied Potable Water Outdoor Use_64853', 'property.Estimated Values - Energy_63529', 'property.Estimated Values - Water_63531', 'property.Fast Food Restaurant - Gross Floor Area (ft2)_63873', 'property.Financial Office - Computer Density (Number Per 1,000 Ft2)_63807', 'property.Financial Office - Gross Floor Area (ft2)_63805', 'property.Financial Office - Number Of Computers_63809', 'property.Financial Office - Number Of Workers On Main Shift_63811', 'property.Financial Office - Percent That Can Be Cooled_63813', 'property.Financial Office - Percent That Can Be Heated_63815', 'property.Financial Office - Weekly Operating Hours_63817', 'property.Financial Office - Worker Density (Number Per 1,000 Ft2)_63819', 'property.Fire Station - Gross Floor Area (ft2)_63911', 'property.Fitness Center/Health Club/Gym - Gross Floor Area (ft2)_63875', 'property.Food Sales - Gross Floor Area (ft2)_65744', 'property.Food Service - Gross Floor Area (ft2)_63877', 'property.Fuel Oil #1 Use (kBtu)_63637', 'property.Fuel Oil #2 Use (kBtu)_63639', 'property.Fuel Oil #4 Use (kBtu)_63641', 'property.Fuel Oil #5 & 6 Use (kBtu)_63643', 'property.Green Power - Offsite (kWh)_63683', 'property.Green Power - Onsite (kWh)_63681', 'property.Hospital (General Medical & Surgical) - Gross Floor Area (ft2)_63879', 'property.Hospital (General Medical & Surgical) - Laboratory_64020', 'property.Hospital (General Medical & Surgical) - Licensed Bed Capacity Density (Number Per 1,000 Ft2)_65831', 'property.Hospital (General Medical & Surgical) - MRI Density (Number Per 1,000 Ft2)_65833', 'property.Hospital (General Medical & Surgical) - Maximum Number Of Floors_64024', 'property.Hospital (General Medical & Surgical) - Number Of MRI Machines_64016', 'property.Hospital (General Medical & Surgical) - Number Of Staffed Beds_64018', 'property.Hospital (General Medical & Surgical) - Onsite Laundry Facility_64022', 'property.Hospital (General Medical & Surgical) - Owned By_64026', 'property.Hospital (General Medical & Surgical) - Percent That Can Be Heated_65837', 'property.Hospital (General Medical & Surgical) - Staffed Bed Density (Number Per 1,000 Ft2)_65839', 'property.Hospital (General Medical & Surgical) - Tertiary Care_64028', 'property.Hospital (General Medical & Surgical)- Full Time Equivalent (FTE) Workers_64014', 'property.Hotel - Amount Of Laundry Processed On-site Annually (short Tons/year)_63775', 'property.Hotel - Commercial Refrigeration Density (Number Per 1,000 Ft2)_63777', 'property.Hotel - Cooking Facilities_63779', 'property.Hotel - Full Service Spa Floor Area (ft2)_63781', 'property.Hotel - Gross Floor Area (ft2)_63773', 'property.Hotel - Gym/fitness  Center Floor Area (ft2)_63783', 'property.Hotel - Hours Per Day Guests Onsite_63785', 'property.Hotel - Number Of Commercial Refrigeration/Freezer Units_63787', 'property.Hotel - Number Of Guest Meals Served Per Year_63789', 'property.Hotel - Number Of Rooms_63791', 'property.Hotel - Number Of Workers On Main Shift_63793', 'property.Hotel - Percent That Can Be Cooled_63795', 'property.Hotel - Percent That Can Be Heated_63797', 'property.Hotel - Room Density (Number Per 1,000 Ft2)_63799', 'property.Hotel - Type Of Laundry Facility_63801', 'property.Hotel - Worker Density (Number Per 1,000 Ft2)_63803', 'property.Ice/Curling Rink - Gross Floor Area (ft2)_65746', 'property.Indirect GHG Emissions (Metric Tons CO2e)_63677', 'property.Indoor Arena - Gross Floor Area (ft2)_65748', 'property.Indoor Water Use (All Water Sources) (kgal)_63657', 'property.Indoor Water Use Intensity (All Water Sources) (gal/ft2)_63659', 'property.Irrigated Area (ft2)_63497', 'property.K-12 School - Computer Density (Number Per 1,000 Ft2)_63823', 'property.K-12 School - Cooking Facilities_63825', 'property.K-12 School - Gross Floor Area (ft2)_63821', 'property.K-12 School - Gymnasium Floor Area (ft2)_63827', 'property.K-12 School - High School_63829', 'property.K-12 School - Months In Use_63831', 'property.K-12 School - Number Of Computers_63833', 'property.K-12 School - Number Of Walk-in Refrigeration/Freezer Units_63835', 'property.K-12 School - Number Of Workers On Main Shift_63837', 'property.K-12 School - Percent That Can Be Cooled_63839', 'property.K-12 School - Percent That Can Be Heated_63841', 'property.K-12 School - Refrigeration Density (Number Per 1,000 Ft2)_63843', 'property.K-12 School - School District_63845', 'property.K-12 School - Student Seating Capacity_63847', 'property.K-12 School - Student Seating Density (Number Per 1,000 Ft2)_63849', 'property.K-12 School - Weekend Operation_63851', 'property.K-12 School - Worker Density (Number Per 1,000 Ft2)_63853', 'property.Kerosene Use (kBtu)_63647', 'property.LAST MODIFIED DATE PROPERTY_64814', 'property.LEED US Project ID_63460', 'property.LIST OF ALL PROPERTY USE TYPES_64782', 'property.Laboratory - Gross Floor Area (ft2)_65750', 'property.Largest Property Use Type - Gross Floor Area (ft2)_63480', 'property.Largest Property Use Type_63478', 'property.Last Modified By - Electric Meters_63515', 'property.Last Modified By - Gas Meters_63519', 'property.Last Modified By - Non-Electric Non-Gas Energy Meters_63523', 'property.Last Modified By - Property_64226', 'property.Last Modified By - Water Meters_64228', 'property.Last Modified Date - Electric Meters_63513', 'property.Last Modified Date - Gas Meters_63517', 'property.Last Modified Date - Non-Electric Non-Gas Energy Meters_63521', 'property.Last Modified Date - Property_63511', 'property.Last Modified Date - Water Meters_63525', 'property.Leed Us Project Id_64768', 'property.Library - Gross Floor Area (ft2)_63881', 'property.Lifestyle Center - Gross Floor Area (ft2)_65752', 'property.List Of All Property Use Types At Property_63476', 'property.Mailing Center/Post Office - Gross Floor Area (ft2)_65754', 'property.Manufacturing/Industrial Plant - Gross Floor Area (ft2)_65756', 'property.Map ID_64235', 'property.Medical Office - Gross Floor Area (ft2)_63883', 'property.Medical Office - Number Of Workers On Main Shift_64042', 'property.Medical Office - Percent That Can Be Cooled_64044', 'property.Medical Office - Percent That Can Be Heated_64046', 'property.Medical Office - Weekly Operating Hours_64048', 'property.Movie Theater - Gross Floor Area (ft2)_65758', 'property.Multifamily Housing - Government Subsidized Housing_63721', 'property.Multifamily Housing - Gross Floor Area (ft2)_63719', 'property.Multifamily Housing - Maximum Number Of Floors_63974', 'property.Multifamily Housing - Number Of Bedrooms Density (Number Per 1,000 Ft2)_63725', 'property.Multifamily Housing - Number Of Bedrooms_63723', 'property.Multifamily Housing - Number Of Dishwasher Hookups In All Units_63972', 'property.Multifamily Housing - Number Of Dishwasher Hookups In Common Area(s)_65828', 'property.Multifamily Housing - Number Of Dishwasher Hookups_65826', 'property.Multifamily Housing - Number Of Laundry Hookups In All Units_63727', 'property.Multifamily Housing - Number Of Laundry Hookups In Common Area(s)_63729', 'property.Multifamily Housing - Number Of Residential Living Units In A High-Rise Building (10 Or More Stories)_63731', 'property.Multifamily Housing - Number Of Residential Living Units In A High-Rise Building Density (Number Per 1,000 Ft2)_63733', 'property.Multifamily Housing - Number Of Residential Living Units In A Low-Rise Building (1-4 Stories)_63735', 'property.Multifamily Housing - Number Of Residential Living Units In A Low-Rise Building Density (Number Per 1,000 Ft2)_63737', 'property.Multifamily Housing - Number Of Residential Living Units In A Mid-Rise Building (5-9 Stories)_63739', 'property.Multifamily Housing - Number Of Residential Living Units In A Mid-Rise Building Density (Number Per 1,000 Ft2)_63741', 'property.Multifamily Housing - Percent Of Gross Floor Area That Is Common Area(s)_63976', 'property.Multifamily Housing - Percent That Can Be Cooled_65231', 'property.Multifamily Housing - Percent That Can Be Heated_63745', 'property.Multifamily Housing - Primary Hot Water Fuel Type (for Units)_63978', 'property.Multifamily Housing - Resident Population Type_63747', 'property.Multifamily Housing - Total Number Of Residential Living Units Density (Number Per 1,000 Ft2)_63751', 'property.Multifamily Housing - Total Number Of Residential Living Units_63749', 'property.Municipally Supplied Potable Water - Mixed Indoor/Outdoor Use (kgal)_63663', 'property.Museum - Gross Floor Area (ft2)_65760', 'property.National Median Reference Property Type_63603', 'property.National Median Reference_64903', 'property.National Median Site Eui_63605', 'property.National Median Source Eui_63607', 'property.National Median Total GHG Emissions (Metric Tons CO2e)_63679', 'property.Natural Gas Use (kBtu)_63938', 'property.Net Emissions (Metric Tons CO2e)_63693', 'property.Non Time Weighted Floor Area_64771', 'property.Non-Refrigerated Warehouse - Gross Floor Area (ft2)_63885', 'property.Non-Refrigerated Warehouse - Number Of Walk-in Refrigeration/Freezer Units_64140', 'property.Non-Refrigerated Warehouse - Number Of Worker On Main Shift_64152', 'property.Non-Refrigerated Warehouse - Percent That Can Be Cooled_64142', 'property.Non-Refrigerated Warehouse - Percent That Can Be Heated_64144', 'property.Non-Refrigerated Warehouse - Walk-in Refrigeration Density (Number Per 1,000 Ft2)_64146', 'property.Non-Refrigerated Warehouse - Weekly Operating Hours_64148', 'property.Non-Refrigerated Warehouse - Worker Density (Number Per 1,000 Ft2)_64150', 'property.Occupancy_63598', 'property.Office - Computer Density (Number Per 1,000 Ft2)_63705', 'property.Office - Gross Floor Area (ft2)_63703', 'property.Office - Number Of Computers_63707', 'property.Office - Number Of Workers On Main Shift_63709', 'property.Office - Percent That Can Be Cooled_63711', 'property.Office - Percent That Can Be Heated_63713', 'property.Office - Weekly Operating Hours_63715', 'property.Office - Worker Density (Number Per 1,000 Ft2)_63717', 'property.Office Computer Density_65002', 'property.On Behalf Of_63923', 'property.Onsite Renewable System Electricty Exported_64931', 'property.Onsite Renewable System Generation_64929', 'property.Organization_63925', 'property.Other - Education - Gross Floor Area (ft2)_65762', 'property.Other - Entertainment/Public Assembly - Gross Floor Area (ft2)_63887', 'property.Other - Gross Floor Area (ft2)_63889', 'property.Other - Lodging/Residential - Gross Floor Area (ft2)_65764', 'property.Other - Mall - Gross Floor Area (ft2)_65766', 'property.Other - Public Services - Gross Floor Area (ft2)_65768', 'property.Other - Recreation - Gross Floor Area (ft2)_65770', 'property.Other - Restaurant/Bar - Gross Floor Area (ft2)_65772', 'property.Other - Services - Gross Floor Area (ft2)_65774', 'property.Other - Specialty Hospital - Gross Floor Area (ft2)_65776', 'property.Other - Stadium - Gross Floor Area (ft2)_65778', 'property.Other - Technology/Science - Gross Floor Area (ft2)_65780', 'property.Other - Utility - Gross Floor Area (ft2)_65782', 'property.Other Use (kBtu)_63946', 'property.Outdoor Water Use (All Water Sources) (kgal)_63661', 'property.Outpatient Rehabilitation/Physical Therapy - Gross Floor Area (ft2)_65784', 'property.Parking - Completely Enclosed Parking Garage Size (ft2)_63857', 'property.Parking - Gross Floor Area (ft2)_63933', 'property.Parking - Open Parking Lot Size (ft2)_63859', 'property.Parking - Partially Enclosed Parking Garage Size (ft2)_63861', 'property.Parking - Supplemental Heating_63863', 'property.Percent Better Than National Median Site Eui_64907', 'property.Percent Better Than National Median Source Eui_64909', 'property.Percent Of Electricity That Is Green Power_63687', 'property.Percent Of Total Electricity Generated From Onsite Renewable Systems_63685', 'property.Performing Arts - Gross Floor Area (ft2)_65786','property.Personal Services (Health/Beauty, Dry Cleaning, Etc.) - Gross Floor Area (ft2)_63891', 'property.Police Station - Gross Floor Area (ft2)_63913', 'property.Pre-school/Daycare - Gross Floor Area (ft2)_65788', 'property.Primary Property Type Epa Calculated_64780', 'property.Primary Property Type Self Selected_65226', 'property.Prison/Incarceration - Gross Floor Area (ft2)_65790', 'property.Propane Use (kBtu)_63649', 'property.Property Data Administrator - Email_63921', 'property.Property Data Administrator_63919', 'property.Property Floor Area Buildngs And Parking_64773', 'property.Property Floor Area Parking_63855', 'property.Property GFA - Calculated (Buildings And Parking) (ft2)_63466', 'property.Property GFA - Calculated (Parking) (ft2)_63470', 'property.Property GFA - Self-Reported (ft2)_63464', 'property.Property Name_65233', 'property.Property Notes_65236', 'property.Propertys Portfolio Manager Account Holder Email_65217', 'property.Propertys Portfolio Manager Account Holder_65215', 'property.Proprty Floor Area Buildings_64775', 'property.Race Track - Gross Floor Area (ft2)_65792', 'property.Refrigerated Warehouse - Gross Floor Area (ft2)_64132', 'property.Refrigerated Warehouse - Number Of Workers On Main Shift_64138', 'property.Refrigerated Warehouse - Weekly Operating Hours_64134', 'property.Refrigerated Warehouse - Worker Density (Number Per 1,000 Ft2)_64136', 'property.Repair Services (Vehicle, Shoe, Locksmith, Etc.) - Gross Floor Area (ft2)_65794', 'property.Residence Hall/ Dormitory - Computer Lab_64050', 'property.Residence Hall/ Dormitory - Dining Hall_64052', 'property.Residence Hall/Dormitory - Gross Floor Area (ft2)_63893', 'property.Residence Hall/Dormitory - Number Of Rooms_64054', 'property.Residence Hall/Dormitory - Percent That Can Be Cooled_64056', 'property.Residence Hall/Dormitory - Percent That Can Be Heated_64058', 'property.Restaurant - Gross Floor Area (ft2)_63895', 'property.Retail Store - Cash Register Density (Number Per 1,000 Ft2)_64060', 'property.Retail Store - Computer Density (Number Per 1,000 Ft2)_64074', 'property.Retail Store - Exterior Entrance To The Public_64062', 'property.Retail Store - Gross Floor Area (ft2)_63897', 'property.Retail Store - Number Of Cash Registers_64064', 'property.Retail Store - Number Of Computers_64068', 'property.Retail Store - Number Of Open Or Closed Refrigeration/Freezer Units_64066', 'property.Retail Store - Number Of Walk-in Refrigeration/Freezer Units_64070', 'property.Retail Store - Number Of Workers On Main Shift_64086', 'property.Retail Store - Open Or Closed Refrigeration Density (Number Per 1,000 Ft2)_64072', 'property.Retail Store - Percent That Can Be Cooled_64076', 'property.Retail Store - Percent That Can Be Heated_64078', 'property.Retail Store - Walk-in Refrigeration Density (Number Per 1,000 Ft2)_64080', 'property.Retail Store - Weekly Operating Hours_64082', 'property.Retail Store - Worker Density (Number Per 1,000 Ft2)_64084', 'property.Roller Rink - Gross Floor Area (ft2)_65796', 'property.Second Largest Property Use Type - Gross Floor Area (ft2)_65227', 'property.Second Largest Property Use Type Gfa_64789', 'property.Second Largest Property Use Type_64787', 'property.Self-Storage Facility - Gross Floor Area (ft2)_63899', 'property.Senior Care Community - Average Number Of Residents_64088', 'property.Senior Care Community - Gross Floor Area (ft2)_64090', 'property.Senior Care Community - Maximum Resident Capacity_64108', 'property.Senior Care Community - Number Of Commercial Refrigeration/ Freezer Units_64092', 'property.Senior Care Community - Number Of Commercial Washing Machines_64094', 'property.Senior Care Community - Number Of Computers_64096', 'property.Senior Care Community - Number Of Residential Electronic Lift Systems_64098', 'property.Senior Care Community - Number Of Residential Washing Machines_64100', 'property.Senior Care Community - Number Of Workers On Main Shift_64110', 'property.Senior Care Community - Percent That Can Be Cooled_64102', 'property.Senior Care Community - Percent That Can Be Heated_64104', 'property.Senior Care Community - Total Number Of Residential Living Units_64106', 'property.Service And Product Provider_63917', 'property.Single Family Home - Gross Floor Area (ft2)_65798', 'property.Site Energy Use (kBtu)_63613', 'property.Social/Meeting Hall - Gross Floor Area (ft2)_65800', 'property.Source Energy Use (kBtu)_63615', 'property.Stadium (Closed) - Gross Floor Area (ft2)_65802', 'property.Stadium (Open) - Gross Floor Area (ft2)_65804', 'property.State Province_65225', 'property.Strip Mall - Gross Floor Area (ft2)_65806', 'property.Supermarket/Grocery - Cooking Facilities_64122', 'property.Supermarket/Grocery - Gross Floor Area (ft2)_63901', 'property.Supermarket/Grocery - Number Of Cash Registers_64114', 'property.Supermarket/Grocery - Number Of Open Or Closed Refrigeration/Freezer Units_64112', 'property.Supermarket/Grocery - Number Of Walk-in Refrigeration/Freezer Units_64116', 'property.Supermarket/Grocery - Number Of Workers On Main Shift_64130', 'property.Supermarket/Grocery - Percent That Can Be Cooled_64118', 'property.Supermarket/Grocery - Percent That Can Be Heated_64120', 'property.Supermarket/Grocery - Walk-in Refrigeration Density (Number Per 1,000 Ft2)_64124', 'property.Supermarket/Grocery - Weekly Operating Hours_64126', 'property.Supermarket/Grocery - Worker Density (Number Per 1,000 Ft2)_64128', 'property.Swimming Pool - Approximate Pool Size_63903', 'property.Swimming Pool - Location Of Pool_63905', 'property.Swimming Pool - Months In Use_63907', 'property.Temporary Values_63569', 'property.Third Largest Property Use Type - Gross Floor Area (ft2)_65228', 'property.Third Largest Property Use Type Gfa_64793', 'property.Third Largest Property Use Type_64791', 'property.Third Party Certification_63932', 'property.Total Waste (Disposed And Diverted) (Tons)_63665', 'property.Total Waste (Disposed And Diverted) - Intensity (lbs/ft2)_63667', 'property.Transportation Terminal/Station - Gross Floor Area (ft2)_65808', 'property.Urgent Care/Clinic/Other Outpatient - Gross Floor Area (ft2)_65810', 'property.Veterinary Office - Gross Floor Area (ft2)_65812', 'property.Vocational School - Gross Floor Area (ft2)_65814', 'property.Wastewater Treatment Plant - Gross Floor Area (ft2)_63909', 'property.Water Alerts_63970', 'property.Water Current Date_63509', 'property.Water Intensity Total_64804', 'property.Water Use Intensity (All Water Sources) (gal/ft2)_63499', 'property.Weather Normalized Site Electricity (kWh)_63621', 'property.Weather Normalized Site Energy Use (kBtu)_63617', 'property.Weather Normalized Site Energy Use_65230', 'property.Weather Normalized Site Natural Gas Use (therms)_63623', 'property.Weather Normalized Source Energy Use (kBtu)_63619', 'property.Wholesale Club/Supercenter- Gross Floor Area (ft2)_65816', 'property.Wood Use (kBtu)_63948', 'property.Worship Facility - Commercial Refrigeration Density (Number Per 1,000 Ft2)_64030', 'property.Worship Facility - Computer Density (Number Per 1,000 Ft2)_64036', 'property.Worship Facility - Cooking Facilities_64038', 'property.Worship Facility - Gross Floor Area (ft2)_63915', 'property.Worship Facility - Number Of Commercial Refrigeration/Freezer Units_64032', 'property.Worship Facility - Number Of Computers_64034', 'property.Worship Facility - Weekly Operating Hours_64040', 'property.address_line_1_63311', 'property.address_line_2_63313', 'property.analysis_end_time_63362', 'property.analysis_start_time_63361', 'property.analysis_state_63363', 'property.analysis_state_message_63364', 'property.bounding_box', 'property.building_certification_63360', 'property.building_count_63341', 'property.campus_63327', 'property.centroid', 'property.city_63315', 'property.conditioned_floor_area_63344', 'property.created_63329', 'property.custom_id_1_63309', 'property.energy_alerts_63358', 'property.generation_date_63350', 'property.geocoding_confidence_67164', 'property.gross_floor_area_63332', 'property.home_energy_score_id_63349', 'property.id', 'property.jurisdiction_property_id_63307', 'property.latitude_63325', 'property.long_lat', 'property.longitude_63326', 'property.lot_number_63323', 'property.notes_count', 'property.occupied_floor_area_63345', 'property.owner_63338', 'property.owner_address_63346', 'property.owner_city_state_63347', 'property.owner_email_63339', 'property.owner_postal_code_63348', 'property.owner_telephone_63340', 'property.postal_code_63321', 'property.property_footprint_67396', 'property.property_state_id', 'property.property_type_63336', 'property.property_view_id', 'property.recent_sale_date_63343', 'property.release_date_63351', 'property.site_eui_modeled_63354', 'property.source_eui_modeled_63357', 'property.space_alerts_63359', 'property.state_63317', 'property.ubid_63308', 'property.updated_63328', 'property.use_description_63333', 'property.year_built_63342'], inplace= True)
		
		# NEED TO MAKE THIS ONLY FOR 2020
		if reporting_year == 2020:
			data_View4.drop(columns = ['10-25k_78097', 'nUBID_77182', 'SUFFIX_78082', 'Exempt Disclosure_78099', 'UBID_77178', 'Link_Type_Description_77184', 'Exempt 2021 Reporting (2020 Data)_78101', 'REGIME_78086', 'SQUARE_78080', 'DGS Outlease_78103', 'OWNER ADDRESS CITY STATE ZIP_78088', '25-50k_78095', 'nSSL_77180', 'SECOND OWNER ADDRESS CITY STATE ZIP_78090', 'LOT_78084', 'property.Refrigerated Warehouse - Percent That Can Be Heated_77820', 'property.Self-Storage Facility - Percent That Can Be Cooled_77883', 'property.Supermarket/Grocery - Number of Computers_77961', 'property.Retail Store - Number of Open or Closed Refrigeration/Freezer Units_77855', 'property.Non-Refrigerated Warehouse - Percent Used for Cold Storage_77791', 'property.Worship Facility - Computer Density (Number per 1,000 sq ft)_78035', 'property.Last Modified By - Property Use_77744', 'property.Wholesale Club/Supercenter- Walk-in Refrigeration Density (Number per 1,000 sq ft)_78027', 'property.Wastewater Treatment Plant - Average Influent Flow (MGD)_77986', 'property.Supermarket/Grocery - Walk-in Refrigeration Density (Number per 1,000 sq ft)_77973', 'property.Hospital (General Medical & Surgical) - Staffed Bed Density (Number per 1,000 sq ft)_77733', 'property.Retail Store - Area of All Walk-in Refrigeration/Freezer Units (ft2)_77839', 'property.Wholesale Club/Supercenter- Cash Register Density (Number per 1,000 sq ft)_77998', 'property.National Median Site Energy Use (kBtu)_77756', 'property.Cooling Degree Days (CDD) (°F)_77655', 'property.Retail Store - Worker Density (Number per 1,000 sq ft)_77870', 'property.Wastewater Treatment Plant - Nutrient Removal_77990', 'property.Refrigerated Warehouse - Percent That Can Be Cooled_77818', 'property.Retail Store - Single Store_77865', 'property.Senior Care Community - Commercial Refrigeration Density (Number per 1,000 sq ft)_77895', 'property.Barracks - Room Density (Number per 1,000 sq ft)_77648', 'property.Senior Care Community - Residential Washing Machine Density (Number per 1,000 sq ft)_77929', 'property.Barracks- Number of Rooms_77642', 'property.Non-Refrigerated Warehouse - Number of Walk-in Refrigeration/Freezer Units_77785', 'property.Hospital (General Medical & Surgical) - Gross Floor Area Used for Food Preparation (ft2)_77707', 'property.Hospital (General Medical & Surgical) - Number of Staffed Beds_77720', 'property.Senior Care Community - Number of Commercial Refrigeration/ Freezer Units_77913', 'property.Courthouse - Number of Computers_77659', 'property.Retail Store - Cash Register Density (Number per 1,000 sq ft)_77841', 'property.Convenience Store with Gas Station - Gross Floor Area (ft2)_77652', 'property.Courthouse - Computer Density (Number per 1,000 sq ft)_77657', 'property.Self-Storage Facility - Number of Computers_77877', 'property.Residence Hall/Dormitory - Number of Rooms_77831', 'property.Senior Care Community - Worker Density (Number per 1,000 sq ft)_77931', 'property.Wholesale Club/Supercenter - Length of All Open or Closed Refrigeration/Freezer Units (ft)_78007', 'property.Distribution Center - Percent Used for Cold Storage_77684', 'property.Bank Branch - Computer Density (Number per 1,000 sq ft)_77629', 'property.Drinking Water Treatment & Distribution - Average Flow (MGD)_77692', 'property.Senior Care Community - Resident Density (Number per 1,000 sq ft)_77927', 'property.Hospital (General Medical & Surgical) - Maximum Number of Floors_77714', 'property.Non-Refrigerated Warehouse - Clear Height (ft)_77783', 'property.Social/Meeting Hall - Worker Density (Number per 1,000 sq ft)_77943', 'property.Barracks- Percent That Can Be Heated_77646', 'property.Medical Office - Number of MRI Machines_77766', 'property.Wholesale Club/Supercenter- Worker Density (Number per 1,000 sq ft)_78031', 'property.Worship Facility - Percent That Can Be Cooled_78048', 'property.Refrigerated Warehouse - Worker Density (Number per 1,000 sq ft)_77825', 'property.Hospital (General Medical & Surgical) - Full Time Equivalent (FTE) Workers Density (Number per 1,000 sq ft)_77705', 'property.Distribution Center - Clear Height (ft)_77672', 'property.Water/Wastewater Site EUI - Adjusted to Current Year (kBtu/gpd)_77994', 'property.Distribution Center - Worker Density (Number per 1,000 sq ft)_77690', 'property.Supermarket/Grocery - Area of All Walk-in Refrigeration/Freezer Units (ft2)_77950', 'property.Refrigerated Warehouse - Clear Height (ft)_77814', 'property.Supermarket/Grocery - Number of Walk-in Refrigeration/Freezer Units_77965', 'property.Wholesale Club/Supercenter- Percent That Can Be Heated_78023', 'property.Retail Store - Length of All Open or Closed Refrigeration/Freezer Units (ft)_77849', 'property.Senior Care Community - Electronic Lift Density (Number per 1,000 sq ft)_77901', 'property.Wholesale Club/Supercenter- Weekly Operating Hours_78029', 'property.Medical Office - Number of Computers_77764', 'property.eGRID Output Emissions Rate (kgCO2e/MBtu)_77695', 'property.Hospital (General Medical & Surgical) - Number of Workers on Main Shift Density (Number per 1,000 sq ft)_77726', 'property.Retail Store - Exterior Entrance to the Public_77847', 'property.Wholesale Club/Supercenter- Percent That Can Be Cooled_78021', 'property.Hospital (General Medical & Surgical) - Percent That Can Be Cooled_77730', 'property.Senior Care Community - Number of Commercial Washing Machines_77911', 'property.Medical Office - Number of Workers on Main Shift_77770', 'property.Distribution Center - Percent That Can Be Cooled_77680', 'property.Senior Care Community - Number of Workers on Main Shift_77923', 'property.Distribution Center - Number of Walk-in Refrigeration/Freezer Units_77676', 'property.Retail Store - Computer Density (Number per 1,000 sq ft)_77843', 'property.Source Energy Use - Adjusted to Current Year (kBtu)_77945', 'property.Retail Store - Walk-in Refrigeration Density (Number per 1,000 sq ft)_77867', 'property.Retail Store - Number of Workers on Main Shift_77859', 'property.Distribution Center - Gross Floor Area (ft2)_77674', 'property.Medical Office - Surgery Center Floor Area (ft2)_77774', 'property.Self-Storage Facility - Percent That Can Be Heated_77885', 'property.Non-Refrigerated Warehouse - Worker Density (Number per 1,000 sq ft)_77796', 'property.Retail Store - Number of Cash Registers_77851', 'property.Wastewater Treatment Plant - Fixed Film Trickle Filtration Process_77988', 'property.Wholesale Club/Supercenter- Number of Walk-in Refrigeration/Freezer Units_78015', 'property.Wholesale Club/Supercenter- Open or Closed Refrigeration Density (Number per 1,000 sq ft)_78019', 'property.Worship Facility - Number of Computers_78044', 'property.wastewater_source_eui_modeled_77391', 'property.Wholesale Club/Supercenter - Cooking Facilities_78002', 'property.Senior Care Community - Commercial Washing Machine Density (Number per 1,000 sq ft)_77897', 'property.Electric Distribution Utility_77697', 'property.Hospital (General Medical & Surgical) - Number of Workers on Main Shift_77724', 'property.Hospital (General Medical & Surgical) - Licensed Bed Capacity_77710', 'property.Retail Store - Open or Closed Refrigeration Density (Number per 1,000 sq ft)_77861', 'property.Bank Branch - Number of Workers on Main Shift_77633', 'property.Social/Meeting Hall - Number of Workers on Main Shift_77939', 'property.Worship Facility - Number of Weekdays Open_78046', 'property.Self-Storage Facility - Clear Height (ft)_77873', 'property.Worship Facility - Seating Capacity_78052', 'property.Senior Care Community - Total Number of Residential Living Units_77919', 'property.Senior Care Community - Number of Residential Washing Machines_77921', 'property.Supermarket/Grocery - Cash Register Density (Number per 1,000 sq ft)_77952', 'property.Distribution Center - Percent That Can Be Heated_77682', 'property.Self-Storage Facility - Worker Density (Number per 1,000 sq ft)_77891', 'property.site_energy_modeled_77383', 'property.National Median Source Energy Use (kBtu)_77758', 'property.Social/Meeting Hall - Number of Computers_77937', 'property.Supermarket/Grocery - Number of Workers on Main Shift_77967', 'property.Wholesale Club/Supercenter- Number of Workers on Main Shift_78017', 'property.Wholesale Club/Supercenter - Area of All Walk-in Refrigeration/Freezer Units (ft2)_77996', 'property.Last Modified Date - Property Use Details_77751', 'property.Hospital (General Medical & Surgical) - Sterilization Density (Number per 1,000 sq ft)_77735', 'property.Barracks- Percent That Can Be Cooled_77644', 'property.Medical Office - Surgical Operating Bed Density (Number per 1,000 sq ft)_77776', 'property.Supermarket/Grocery - Number of Open or Closed Refrigeration/Freezer Units_77963', 'property.Self-Storage Facility - Weekly Operating Hours_77889', 'property.Courthouse - Worker Density (Number per 1,000 sq ft)_77666', 'property.Senior Care Community - Licensed Bed Capacity Density (Number per 1,000 sq ft)_77906', 'property.Source EUI - Adjusted to Current Year (kBtu/ft2)_77946', 'property.Non-Refrigerated Warehouse - Number of Workers on Main Shift_77787', 'property.Wholesale Club/Supercenter - Single Store_78025', 'property.Refrigerated Warehouse - Number of Workers on Main Shift_77816', 'property.Self-Storage Facility - Number of Workers on Main Shift_77881', 'property.Wholesale Club/Supercenter- Number of Cash Registers_78009', 'property.Wholesale Club/Supercenter- Number of Computers_78011', 'property.Hospital (General Medical & Surgical) - Licensed Bed Capacity Density (Number per 1,000 sq ft)_77712', 'property.Supermarket/Grocery - Number of Cash Registers_77959', 'property.Worship Facility - Gross Floor Area Used for Food Preparation (ft2)_78038', 'property.Residential Care Facility - Gross Floor Area (ft2)_77837', 'property.Self-Storage Facility - Computer Density (Number per 1,000 sq ft)_77875', 'property.Retail Store - Number of Walk-in Refrigeration/Freezer Units_77857', 'property.Medical Office - Number of Surgical Operating Beds_77768', 'property.Worship Facility - Open All Weekdays_78040', 'property.Site Energy Use - Adjusted to Current Year (kBtu)_77934', 'property.Courthouse - Number of Workers on Main Shift_77661', 'property.Supermarket/Grocery - Open or Closed Refrigeration Density (Number per 1,000 sq ft)_77969', 'property.Supermarket/Grocery - Worker Density (Number per 1,000 sq ft)_77976', 'property.Wastewater Treatment Plant - Plant Design Flow Rate (MGD)_77992', 'property.Site EUI - Adjusted to Current Year (kBtu/ft2)_77935', 'property.Supermarket/Grocery - Computer Density (Number per 1,000 sq ft)_77954', 'property.Hospital (General Medical & Surgical) - MRI Density (Number per 1,000 sq ft)_77716', 'property.Wholesale Club/Supercenter- Number of Open or Closed Refrigeration/Freezer Units_78013', 'property.Water/Wastewater Source EUI - Adjusted to Current Year (kBtu/gpd)_77995', 'property.source_energy_modeled_77385', 'property.Refrigerated Warehouse - Percent Used for Cold Storage_77822', 'property.Retail Store - Number of Computers_77853', 'property.Senior Care Community - Average Number of Residents_77893', 'property.Hospital (General Medical & Surgical) - Number of Sterilization Units_77722', 'property.Wholesale Club/Supercenter- Computer Density (Number per 1,000 sq ft)_78000', 'property.Residence Hall/Dormitory - Room Density (Number per 1,000 sq ft)_77835', 'property.Self-Storage Facility - Number of Walk-in Refrigeration/Freezer Units_77879', 'property.Medical Office - Worker Density (Number per 1,000 sq ft)_77779', 'property.Last Modified By - Property Use Details_77746', 'property.Medical Office - MRI Machine Density (Number per 1,000 sq ft)_77762', 'property.Direct GHG Emissions Intensity (kgCO2e/ft2)_77670', 'property.Heating Degree Days (HDD) (°F)_77702', 'property.Retail Store - Cooking Facilities_77845', 'property.Senior Care Community - Number of Residential Electronic Lift Systems_77917', 'property.wastewater_site_eui_modeled_77389', 'property.Worship Facility - Commercial Refrigeration Density (Number per 1,000 sq ft)_78033', 'property.Senior Care Community - Computer Density (Number per 1,000 sq ft)_77899', 'property.Distribution Center - Number of Workers on Main Shift_77678', 'property.Bank Branch - Number of Computers_77631', 'property.Supermarket/Grocery - Length of All Open or Closed Refrigeration/Freezer Units (ft)_77957', 'property.Social/Meeting Hall - Weekly Operating Hours_77941', 'property.Wastewater Treatment Plant - Average Influent Biological Oxygen Demand (BOD5) (mg/l)_77984', 'property.Senior Care Community - Living Unit Density (Number per 1,000 sq ft)_77908', 'property.Wastewater Treatment Plant - Average Effluent Biological Oxygen Demand (BOD5) (mg/l)_77982', 'property.Bank Branch - Worker Density (Number per 1,000 sq ft)_77638', 'property.Distribution Center - Weekly Operating Hours_77688', 'property.Repair Services (Vehicle, Shoe, Locksmith, etc.) - Gross Floor Area (ft2)_77827', 'property.Hospital (General Medical & Surgical) - Number of MRI Machines_77718', 'property.Indirect GHG Emissions Intensity (kgCO2e/ft2)_77739', 'property.Worship Facility - Percent That Can Be Heated_78050', 'property.Senior Care Community - Licensed Bed Capacity_77904', 'property.Distribution Center - Walk-in Refrigeration Density (Number per 1,000 sq ft)_77686', 'property.Worship Facility - Number of Commercial Refrigeration/Freezer Units_78042', 'property.Last Modified Date - Property Use_77749', 'property.Non-Refrigerated Warehouse - Walk-in Refrigeration Density (Number per 1,000 sq ft)_77793', 'property.Self-Storage Facility - Percent Used For Cold Storage_77887', 'property.Medical Office - Computer Density (Number per 1,000 sq ft)_77760', 'property.Senior Care Community - Number of Computers_77915', 'property.Wholesale Club/Supercenter- Exterior Entrance to the Public_78004'], inplace= True)

		#Renames/reformats all relevant columns


		data_View4['Merge ID - 1'] = data_View4['REPORTINGYEAR'].apply(str) + '-' + (data_View4['jurisdiction_tax_lot_id_63306'])
		data_View4['Merge ID - 2'] = data_View4['REPORTINGYEAR'].apply(str) + '-' + (data_View4['property.pm_property_id_63304'])
		data_View4['Merge ID - 2'] = np.where(data_View4['property.pm_property_id_63304'] == '', data_View4['REPORTINGYEAR'].apply(str) + '-' + data_View4['jurisdiction_tax_lot_id_63306'],data_View4['Merge ID - 2'])

		
		for item in data_View4['property.pm_property_id_63304']:
			if item != None :	
				data_View4['PID'] = 'PM' + data_View4['property.pm_property_id_63304']
			
		data_View4['PID'] = np.where(data_View4['property.pm_property_id_63304'] == '', 'DC' + data_View4['jurisdiction_tax_lot_id_63306'].str.replace('-',''),data_View4['PID'])
		data_View4.rename(columns={'property.District Steam Use (kBtu)_63651':'DISTRSTEAM_KBTU','property.District Chilled Water Use (kBtu)_63655':'DISTRCHILLEDWATER_KBTU','property.District Hot Water Use (kBtu)_63653': 'DISTRHOTWATER_KBTU','property.Electricity Use - Generated From Onsite Renewable Systems And Used Onsite (kWh)_63629': 'ELECTRICITYUSE_RENEWABLE_KWH','property.Water Score (Multifamily Only)_63501': 'WATERSCORE_MFPROPERTIES', 'jurisdiction_tax_lot_id_63306' : 'DCREALPROPERTYID','property.pm_property_id_63304' : 'PMPROPERTYID','property.property_name_63324' : 'PROPERTYNAME','property.pm_parent_property_id_63305' : 'PMPARENTPROPERTYID','property.Parent Property Name_63444' : 'PARENTPROPERTYNAME','Compliance Status' : 'REPORTSTATUS','address_line_1_63312' : 'ADDRESSOFRECORD','OWNERNAME_63370' : 'OWNEROFRECORD','WARD_63378' : 'WARD','property.Address line 1 - custom_67813' : 'REPORTEDADDRESS','city_63316' : 'CITY','state_63318' : 'STATE','postal_code_63322' : 'POSTALCODE','Year Built_63383' : 'YEARBUILT','property.Primary Property Type - Self Selected_63472' : 'PRIMARYPROPERTYTYPE_SELFSELECT','property.Primary Property Type - Portfolio Manager-Calculated_65237' : 'PRIMARYPROPERTYTYPE_EPACALC','SumOfGBA_63380' : 'TAXRECORDFLOORAREA','property.Property GFA - Calculated (Buildings) (ft2)_63468' : 'REPORTEDBUILDINGGROSSFLOORAREA','property.energy_score_63334' : 'ENERGYSTARSCORE','property.site_eui_63352' : 'SITEEUI_KBTU_FT','property.site_eui_weather_normalized_63353' : 'WEATHERNORMALZEDSITEEUI_KBTUFT','property.source_eui_63355' : 'SOURCEEUI_KBTU_FT','property.source_eui_weather_normalized_63356' : 'WEATHERNORMALZEDSOURCEEUI_KBTUFT','property.Total GHG Emissions (Metric Tons CO2e)_63671' : 'TOTGHGEMISSIONS_METRICTONSCO2E','property.Total GHG Emissions Intensity (kgCO2e/ft2)_63673' : 'TOTGHGEMISSINTENSITY_KGCO2EFT','property.Water Use (All Water Sources) (kgal)_63495' : 'WATERUSE_ALLWATERSOURCES_KGAL','property.Electricity Use - Grid Purchase (kWh)_63627' : 'ELECTRICITYUSE_GRID_KWH','property.Natural Gas Use (therms)_63635' : 'NATURALGASUSE_THERMS','property.fuel_use' : 'FUELOILANDDIESELFUELUSEKBTU', 'property.Elec - Jan_65690': 'ELECTRICITYUSE_KBTU_JANUARY', 'property.Elec - Feb_65688': 'ELECTRICITYUSE_KBTU_FEBRUARY', 'property.Elec - March_65686': 'ELECTRICITYUSE_KBTU_MARCH',  'property.Elec - Apr_65684': 'ELECTRICITYUSE_KBTU_APRIL', 'property.Elec - May_65682': 'ELECTRICITYUSE_KBTU_MAY', 'property.Elec - June_65680': 'ELECTRICITYUSE_KBTU_JUNE', 'property.Elec - July_65678': 'ELECTRICITYUSE_KBTU_JULY', 'property.Elec - Aug_65676': 'ELECTRICITYUSE_KBTU_AUGUST', 'property.Elec - Sept_65674': 'ELECTRICITYUSE_KBTU_SEPTEMBER', 'property.Elec - Oct_65672': 'ELECTRICITYUSE_KBTU_OCTOBER', 'property.Elec - Nov_65670': 'ELECTRICITYUSE_KBTU_NOVEMBER',  'property.Elec - Dec_65668': 'ELECTRICITYUSE_KBTU_DECEMBER', 'property.NG - Jan_65714': 'NATURALGAS_KBTU_JANUARY' , 'property.NG - Feb_65712': 'NATURALGAS_KBTU_FEBRUARY', 'property.NG - March_65710': 'NATURALGAS_KBTU_MARCH', 'property.NG - Apr_65708': 'NATURALGAS_KBTU_APRIL', 'property.NG - May_65706': 'NATURALGAS_KBTU_MAY', 'property.NG - June_65704': 'NATURALGAS_KBTU_JUNE',  'property.NG - July_65702': 'NATURALGAS_KBTU_JULY', 'property.NG - Aug_65700': 'NATURALGAS_KBTU_AUGUST', 'property.NG - Sept_65698': 'NATURALGAS_KBTU_SEPTEMBER', 'property.NG - Oct_65696': 'NATURALGAS_KBTU_OCTOBER', 'property.NG - Nov_65694': 'NATURALGAS_KBTU_NOVEMBER', 'property.NG - Dec_65692': 'NATURALGAS_KBTU_DECEMBER', 'property.Metered Areas  (Water)_63505' : 'METEREDAREAS_WATER','property.Metered Areas (Energy)_63503' : 'METEREDAREAS_ENERGY','property.property_notes_63335' : 'OWNERPROVIDEDPUBLICNOTES','LatX_63409' : 'X', 'LongY_63411' : 'Y','updated_63330':'LASTUPDATE'}, inplace= True)
		data_View4['DCREALPROPERTYID'] = data_View4['DCREALPROPERTYID'].str.replace('-','_')
		data_View4['ENERGYSTARSCORE'] = data_View4['ENERGYSTARSCORE'].replace(0, np.nan)
		data_View4.drop(data_View4[(data_View4['PMPROPERTYID'] == '')&(data_View4['TAXRECORDFLOORAREA'] <50000)].index, inplace= True)
		


		data_View4.set_index('DCREALPROPERTYID',inplace = True)
		data_View4.to_excel('CSV output\\Disclosure_'+str(reporting_year)+'_'+tstamp+'.xlsx')
		print (reporting_year)	
		
		#try:
		SEEDClient.orgID = '313'
		payload_file = {'file': ('CSV output\\Disclosure_'+str(reporting_year)+'_'+tstamp+'.xlsx',open('CSV output\\Disclosure_'+str(reporting_year)+'_'+tstamp+'.xlsx', 'rb'))}
		payload_data = {'import_record': '2006', 'source_type': 'Assessed Raw'}
		SEED_Upload_Data = SEEDClient.post_newfile(payload_file, payload_data)
		
		SEED_Upload_Data_temp = json.loads(SEED_Upload_Data.text)
		SEED_Upload_Data_ID = str(SEED_Upload_Data_temp['import_file_id'])
		payload2 = {'cycle_id': '318'}
		data_save = SEEDClient.post_save_newfile(SEED_Upload_Data_ID, payload2)
		prog_check = 0
		while prog_check != 100:
			data_save_status = SEEDClient.get_save_newfile_progress(SEED_Upload_Data_ID)
			data_save_status_temp = json.loads(data_save_status.text)
			prog_check = data_save_status_temp['progress']
			prog_status = data_save_status_temp['status']	
			print (prog_check, prog_status)

		payload3 = {"mappings":[{"from_field":"DCREALPROPERTYID","to_field":"DCREALPROPERTYID","to_field_display_name":"DCREALPROPERTYID","to_table_name":"TaxLotState"},{"from_field":"X","to_field":"X","to_field_display_name":"X","to_table_name":"TaxLotState"},{"from_field":"Y","to_field":"Y","to_field_display_name":"Y","to_table_name":"TaxLotState"},{"from_field":"OWNEROFRECORD","to_field":"OWNEROFRECORD","to_field_display_name":"OWNEROFRECORD","to_table_name":"TaxLotState"},{"from_field":"TAXRECORDFLOORAREA","to_field":"TAXRECORDFLOORAREA","to_field_display_name":"TAXRECORDFLOORAREA","to_table_name":"TaxLotState"},{"from_field":"WARD","to_field":"WARD","to_field_display_name":"WARD","to_table_name":"TaxLotState"},{"from_field":"YEARBUILT","to_field":"YEARBUILT","to_field_display_name":"YEARBUILT","to_table_name":"PropertyState"},{"from_field":"ADDRESSOFRECORD","to_field":"ADDRESSOFRECORD","to_field_display_name":"ADDRESSOFRECORD","to_table_name":"TaxLotState"},{"from_field":"CITY","to_field":"CITY","to_field_display_name":"CITY","to_table_name":"TaxLotState"},{"from_field":"POSTALCODE","to_field":"POSTALCODE","to_field_display_name":"POSTALCODE","to_table_name":"TaxLotState"},{"from_field":"STATE","to_field":"STATE","to_field_display_name":"STATE","to_table_name":"TaxLotState"},{"from_field":"REPORTEDADDRESS","to_field":"REPORTEDADDRESS","to_field_display_name":"REPORTEDADDRESS","to_table_name":"PropertyState"},{"from_field":"ELECTRICITYUSE_GRID_KWH","to_field":"ELECTRICITYUSE_GRID_KWH","to_field_display_name":"ELECTRICITYUSE_GRID_KWH","to_table_name":"PropertyState"},{"from_field":"METEREDAREAS_WATER","to_field":"METEREDAREAS_WATER","to_field_display_name":"METEREDAREAS_WATER","to_table_name":"PropertyState"},{"from_field":"METEREDAREAS_ENERGY","to_field":"METEREDAREAS_ENERGY","to_field_display_name":"METEREDAREAS_ENERGY","to_table_name":"PropertyState"},{"from_field":"NATURALGASUSE_THERMS","to_field":"NATURALGASUSE_THERMS","to_field_display_name":"NATURALGASUSE_THERMS","to_table_name":"PropertyState"},{"from_field":"PARENTPROPERTYNAME","to_field":"PARENTPROPERTYNAME","to_field_display_name":"PARENTPROPERTYNAME","to_table_name":"PropertyState"},{"from_field":"PRIMARYPROPERTYTYPE_EPACALC","to_field":"PRIMARYPROPERTYTYPE_EPACALC","to_field_display_name":"PRIMARYPROPERTYTYPE_EPACALC","to_table_name":"PropertyState"},{"from_field":"PRIMARYPROPERTYTYPE_SELFSELECT","to_field":"PRIMARYPROPERTYTYPE_SELFSELECT","to_field_display_name":"PRIMARYPROPERTYTYPE_SELFSELECT","to_table_name":"PropertyState"},{"from_field":"REPORTEDBUILDINGGROSSFLOORAREA","to_field":"REPORTEDBUILDINGGROSSFLOORAREA","to_field_display_name":"REPORTEDBUILDINGGROSSFLOORAREA","to_table_name":"PropertyState"},{"from_field":"TOTGHGEMISSIONS_METRICTONSCO2E","to_field":"TOTGHGEMISSIONS_METRICTONSCO2E","to_field_display_name":"TOTGHGEMISSIONS_METRICTONSCO2E","to_table_name":"PropertyState"},{"from_field":"TOTGHGEMISSINTENSITY_KGCO2EFT","to_field":"TOTGHGEMISSINTENSITY_KGCO2EFT","to_field_display_name":"TOTGHGEMISSINTENSITY_KGCO2EFT","to_table_name":"PropertyState"},{"from_field":"WATERSCORE_MFPROPERTIES","to_field":"WATERSCORE_MFPROPERTIES","to_field_display_name":"WATERSCORE_MFPROPERTIES","to_table_name":"PropertyState"},{"from_field":"WATERUSE_ALLWATERSOURCES_KGAL","to_field":"WATERUSE_ALLWATERSOURCES_KGAL","to_field_display_name":"WATERUSE_ALLWATERSOURCES_KGAL","to_table_name":"PropertyState"},{"from_field":"ENERGYSTARSCORE","to_field":"ENERGYSTARSCORE","to_field_display_name":"ENERGYSTARSCORE","to_table_name":"PropertyState"},{"from_field":"PMPARENTPROPERTYID","to_field":"PMPARENTPROPERTYID","to_field_display_name":"PMPARENTPROPERTYID","to_table_name":"PropertyState"},{"from_field":"PMPROPERTYID","to_field":"PMPROPERTYID","to_field_display_name":"PMPROPERTYID","to_table_name":"PropertyState"},{"from_field":"PROPERTYNAME","to_field":"PROPERTYNAME","to_field_display_name":"PROPERTYNAME","to_table_name":"PropertyState"},{"from_field":"OWNERPROVIDEDPUBLICNOTES","to_field":"OWNERPROVIDEDPUBLICNOTES","to_field_display_name":"OWNERPROVIDEDPUBLICNOTES","to_table_name":"PropertyState"},{"from_field":"SITEEUI_KBTU_FT","to_field":"SITEEUI_KBTU_FT","to_field_display_name":"SITEEUI_KBTU_FT","to_table_name":"PropertyState"},{"from_field":"WEATHERNORMALZEDSITEEUI_KBTUFT","to_field":"WEATHERNORMALZEDSITEEUI_KBTUFT","to_field_display_name":"WEATHERNORMALZEDSITEEUI_KBTUFT","to_table_name":"PropertyState"},{"from_field":"SOURCEEUI_KBTU_FT","to_field":"SOURCEEUI_KBTU_FT","to_field_display_name":"SOURCEEUI_KBTU_FT","to_table_name":"PropertyState"},{"from_field":"WEATHERNORMALZEDSOURCEEUI_KBTUFT","to_field":"WEATHERNORMALZEDSOURCEEUI_KBTUFT","to_field_display_name":"WEATHERNORMALZEDSOURCEEUI_KBTUFT","to_table_name":"PropertyState"},{"from_field":"REPORTSTATUS","to_field":"REPORTSTATUS","to_field_display_name":"REPORTSTATUS","to_table_name":"PropertyState"},{"from_field":"FUELOILANDDIESELFUELUSEKBTU","to_field":"FUELOILANDDIESELFUELUSEKBTU","to_field_display_name":"FUELOILANDDIESELFUELUSEKBTU","to_table_name":"PropertyState"},{"from_field":"REPORTINGYEAR","to_field":"REPORTINGYEAR","to_field_display_name":"REPORTINGYEAR","to_table_name":"PropertyState"},{"from_field":"ELECTRICITYUSE_KBTU_JANUARY","to_field":"ELECTRICITYUSE_KBTU_JANUARY","to_field_display_name":"ELECTRICITYUSE_KBTU_JANUARY","to_table_name":"PropertyState"},{"from_field":"ELECTRICITYUSE_KBTU_FEBRUARY","to_field":"ELECTRICITYUSE_KBTU_FEBRUARY","to_field_display_name":"ELECTRICITYUSE_KBTU_FEBRUARY","to_table_name":"PropertyState"},{"from_field":"ELECTRICITYUSE_KBTU_MARCH","to_field":"ELECTRICITYUSE_KBTU_MARCH","to_field_display_name":"ELECTRICITYUSE_KBTU_MARCH","to_table_name":"PropertyState"},{"from_field":"ELECTRICITYUSE_KBTU_APRIL","to_field":"ELECTRICITYUSE_KBTU_APRIL","to_field_display_name":"ELECTRICITYUSE_KBTU_APRIL","to_table_name":"PropertyState"},{"from_field":"ELECTRICITYUSE_KBTU_MAY","to_field":"ELECTRICITYUSE_KBTU_MAY","to_field_display_name":"ELECTRICITYUSE_KBTU_MAY","to_table_name":"PropertyState"},{"from_field":"ELECTRICITYUSE_KBTU_JUNE","to_field":"ELECTRICITYUSE_KBTU_JUNE","to_field_display_name":"ELECTRICITYUSE_KBTU_JUNE","to_table_name":"PropertyState"},{"from_field":"ELECTRICITYUSE_KBTU_JULY","to_field":"ELECTRICITYUSE_KBTU_JULY","to_field_display_name":"ELECTRICITYUSE_KBTU_JULY","to_table_name":"PropertyState"},{"from_field":"ELECTRICITYUSE_KBTU_AUGUST","to_field":"ELECTRICITYUSE_KBTU_AUGUST","to_field_display_name":"ELECTRICITYUSE_KBTU_AUGUST","to_table_name":"PropertyState"},{"from_field":"ELECTRICITYUSE_KBTU_SEPTEMBER","to_field":"ELECTRICITYUSE_KBTU_SEPTEMBER","to_field_display_name":"ELECTRICITYUSE_KBTU_SEPTEMBER","to_table_name":"PropertyState"},{"from_field":"ELECTRICITYUSE_KBTU_OCTOBER","to_field":"ELECTRICITYUSE_KBTU_OCTOBER","to_field_display_name":"ELECTRICITYUSE_KBTU_OCTOBER","to_table_name":"PropertyState"},{"from_field":"ELECTRICITYUSE_KBTU_NOVEMBER","to_field":"ELECTRICITYUSE_KBTU_NOVEMBER","to_field_display_name":"ELECTRICITYUSE_KBTU_NOVEMBER","to_table_name":"PropertyState"},{"from_field":"ELECTRICITYUSE_KBTU_DECEMBER","to_field":"ELECTRICITYUSE_KBTU_DECEMBER","to_field_display_name":"ELECTRICITYUSE_KBTU_DECEMBER","to_table_name":"PropertyState"},{"from_field":"NATURALGAS_KBTU_JANUARY","to_field":"NATURALGAS_KBTU_JANUARY","to_field_display_name":"NATURALGAS_KBTU_JANUARY","to_table_name":"PropertyState"},{"from_field":"NATURALGAS_KBTU_FEBRUARY","to_field":"NATURALGAS_KBTU_FEBRUARY","to_field_display_name":"NATURALGAS_KBTU_FEBRUARY","to_table_name":"PropertyState"},{"from_field":"NATURALGAS_KBTU_MARCH","to_field":"NATURALGAS_KBTU_MARCH","to_field_display_name":"NATURALGAS_KBTU_MARCH","to_table_name":"PropertyState"},{"from_field":"NATURALGAS_KBTU_APRIL","to_field":"NATURALGAS_KBTU_APRIL","to_field_display_name":"NATURALGAS_KBTU_APRIL","to_table_name":"PropertyState"},{"from_field":"NATURALGAS_KBTU_MAY","to_field":"NATURALGAS_KBTU_MAY","to_field_display_name":"NATURALGAS_KBTU_MAY","to_table_name":"PropertyState"},{"from_field":"NATURALGAS_KBTU_JUNE","to_field":"NATURALGAS_KBTU_JUNE","to_field_display_name":"NATURALGAS_KBTU_JUNE","to_table_name":"PropertyState"},{"from_field":"NATURALGAS_KBTU_JULY","to_field":"NATURALGAS_KBTU_JULY","to_field_display_name":"NATURALGAS_KBTU_JULY","to_table_name":"PropertyState"},{"from_field":"NATURALGAS_KBTU_AUGUST","to_field":"NATURALGAS_KBTU_AUGUST","to_field_display_name":"NATURALGAS_KBTU_AUGUST","to_table_name":"PropertyState"},{"from_field":"NATURALGAS_KBTU_SEPTEMBER","to_field":"NATURALGAS_KBTU_SEPTEMBER","to_field_display_name":"NATURALGAS_KBTU_SEPTEMBER","to_table_name":"PropertyState"},{"from_field":"NATURALGAS_KBTU_OCTOBER","to_field":"NATURALGAS_KBTU_OCTOBER","to_field_display_name":"NATURALGAS_KBTU_OCTOBER","to_table_name":"PropertyState"},{"from_field":"NATURALGAS_KBTU_NOVEMBER","to_field":"NATURALGAS_KBTU_NOVEMBER","to_field_display_name":"NATURALGAS_KBTU_NOVEMBER","to_table_name":"PropertyState"},{"from_field":"NATURALGAS_KBTU_DECEMBER","to_field":"NATURALGAS_KBTU_DECEMBER","to_field_display_name":"NATURALGAS_KBTU_DECEMBER","to_table_name":"PropertyState"},{"from_field":"Merge ID - 1","to_field":"jurisdiction_tax_lot_id","to_field_display_name":"Jurisdiction Tax Lot ID","to_table_name":"TaxLotState"},{"from_field":"Merge ID - 2","to_field":"pm_property_id","to_field_display_name":"PM Property ID","to_table_name":"PropertyState"},{"from_field":"PID","to_field":"PID","to_field_display_name":"PID","to_table_name":"PropertyState"},{"from_field":"DISTRSTEAM_KBTU","to_field":"DISTRSTEAM_KBTU","to_field_display_name":"DISTRSTEAM_KBTU","to_table_name":"PropertyState"},{"from_field":"DISTRCHILLEDWATER_KBTU","to_field":"DISTRCHILLEDWATER_KBTU","to_field_display_name":"DISTRCHILLEDWATER_KBTU","to_table_name":"PropertyState"},{"from_field":"DISTRHOTWATER_KBTU","to_field":"DISTRHOTWATER_KBTU","to_field_display_name":"DISTRHOTWATER_KBTU","to_table_name":"PropertyState"},{"from_field":"ELECTRICITYUSE_RENEWABLE_KWH","to_field":"ELECTRICITYUSE_RENEWABLE_KWH","to_field_display_name":"ELECTRICITYUSE_RENEWABLE_KWH","to_table_name":"PropertyState"},{"from_field":"LASTUPDATE","to_field":"LASTUPDATE","to_field_display_name":"LASTUPDATE","to_table_name":"PropertyState"}]}
		data_map_save = SEEDClient.post_save_column_mappings(SEED_Upload_Data_ID, payload3)
		payload4 = {"remap":True,"mark_as_done":False}
		data_map = SEEDClient.post_perform_mapping(SEED_Upload_Data_ID, payload4)
		prog_check = 0
		while prog_check != 100:
			data_map_status = SEEDClient.get_perform_mapping_status(SEED_Upload_Data_ID)
			data_map_status_temp = json.loads(data_map_status.text)
			prog_check = data_map_status_temp['progress']
			prog_status = data_map_status_temp['status']
			print (prog_check, prog_status)		
		data_quality_check = SEEDClient.post_data_quality_check_import(SEED_Upload_Data_ID,'313')

		prog_check = 0
		while prog_check != 100:
			data_quality_status = SEEDClient.get_data_quality_check_import_status(SEED_Upload_Data_ID)
			data_quality_status_temp = json.loads(data_quality_status.text)
			prog_check = data_quality_status_temp['progress']
			prog_status = data_quality_status_temp['status_message']
			print (prog_check, prog_status)

		data_map_status = SEEDClient.post_perform_mapping_stop(SEED_Upload_Data_ID,'313')
		data_match = SEEDClient.post_start_matching(SEED_Upload_Data_ID)
		prog_check = 0
		while prog_check != 100:
			data_matching_status = SEEDClient.get_start_matching_status(SEED_Upload_Data_ID)
			data_matching_status_temp = json.loads(data_matching_status.text)
			prog_check = data_matching_status_temp['progress']
			prog_status = data_matching_status_temp['status_message']	
			print (prog_check, prog_status)
	"""
	except:
		sleep(5)
		SEEDClient.orgID = '313'
		payload_file = {'file': ('CSV output\\Disclosure_'+str(reporting_year)+'_'+tstamp+'.xlsx',open('CSV output\\Disclosure_'+str(reporting_year)+'_'+tstamp+'.xlsx', 'rb'))}
		payload_data = {'import_record': '2006', 'source_type': 'Assessed Raw'}
		SEED_Upload_Data = SEEDClient.post_newfile(payload_file, payload_data)
		
		SEED_Upload_Data_temp = json.loads(SEED_Upload_Data.text)
		SEED_Upload_Data_ID = str(SEED_Upload_Data_temp['import_file_id'])
		payload2 = {'cycle_id': '318'}
		data_save = SEEDClient.post_save_newfile(SEED_Upload_Data_ID, payload2)
		prog_check = 0
		while prog_check != 100:
			data_save_status = SEEDClient.get_save_newfile_progress(SEED_Upload_Data_ID)
			data_save_status_temp = json.loads(data_save_status.text)
			prog_check = data_save_status_temp['progress']
			prog_status = data_save_status_temp['status']	
			print (prog_check, prog_status)

		payload3 = {"mappings":[{"from_field":"DCREALPROPERTYID","to_field":"DCREALPROPERTYID","to_field_display_name":"DCREALPROPERTYID","to_table_name":"TaxLotState"},{"from_field":"X","to_field":"X","to_field_display_name":"X","to_table_name":"TaxLotState"},{"from_field":"Y","to_field":"Y","to_field_display_name":"Y","to_table_name":"TaxLotState"},{"from_field":"OWNEROFRECORD","to_field":"OWNEROFRECORD","to_field_display_name":"OWNEROFRECORD","to_table_name":"TaxLotState"},{"from_field":"TAXRECORDFLOORAREA","to_field":"TAXRECORDFLOORAREA","to_field_display_name":"TAXRECORDFLOORAREA","to_table_name":"TaxLotState"},{"from_field":"WARD","to_field":"WARD","to_field_display_name":"WARD","to_table_name":"TaxLotState"},{"from_field":"YEARBUILT","to_field":"YEARBUILT","to_field_display_name":"YEARBUILT","to_table_name":"PropertyState"},{"from_field":"ADDRESSOFRECORD","to_field":"ADDRESSOFRECORD","to_field_display_name":"ADDRESSOFRECORD","to_table_name":"TaxLotState"},{"from_field":"CITY","to_field":"CITY","to_field_display_name":"CITY","to_table_name":"TaxLotState"},{"from_field":"POSTALCODE","to_field":"POSTALCODE","to_field_display_name":"POSTALCODE","to_table_name":"TaxLotState"},{"from_field":"STATE","to_field":"STATE","to_field_display_name":"STATE","to_table_name":"TaxLotState"},{"from_field":"REPORTEDADDRESS","to_field":"REPORTEDADDRESS","to_field_display_name":"REPORTEDADDRESS","to_table_name":"PropertyState"},{"from_field":"ELECTRICITYUSE_GRID_KWH","to_field":"ELECTRICITYUSE_GRID_KWH","to_field_display_name":"ELECTRICITYUSE_GRID_KWH","to_table_name":"PropertyState"},{"from_field":"METEREDAREAS_WATER","to_field":"METEREDAREAS_WATER","to_field_display_name":"METEREDAREAS_WATER","to_table_name":"PropertyState"},{"from_field":"METEREDAREAS_ENERGY","to_field":"METEREDAREAS_ENERGY","to_field_display_name":"METEREDAREAS_ENERGY","to_table_name":"PropertyState"},{"from_field":"NATURALGASUSE_THERMS","to_field":"NATURALGASUSE_THERMS","to_field_display_name":"NATURALGASUSE_THERMS","to_table_name":"PropertyState"},{"from_field":"PARENTPROPERTYNAME","to_field":"PARENTPROPERTYNAME","to_field_display_name":"PARENTPROPERTYNAME","to_table_name":"PropertyState"},{"from_field":"PRIMARYPROPERTYTYPE_EPACALC","to_field":"PRIMARYPROPERTYTYPE_EPACALC","to_field_display_name":"PRIMARYPROPERTYTYPE_EPACALC","to_table_name":"PropertyState"},{"from_field":"PRIMARYPROPERTYTYPE_SELFSELECT","to_field":"PRIMARYPROPERTYTYPE_SELFSELECT","to_field_display_name":"PRIMARYPROPERTYTYPE_SELFSELECT","to_table_name":"PropertyState"},{"from_field":"REPORTEDBUILDINGGROSSFLOORAREA","to_field":"REPORTEDBUILDINGGROSSFLOORAREA","to_field_display_name":"REPORTEDBUILDINGGROSSFLOORAREA","to_table_name":"PropertyState"},{"from_field":"TOTGHGEMISSIONS_METRICTONSCO2E","to_field":"TOTGHGEMISSIONS_METRICTONSCO2E","to_field_display_name":"TOTGHGEMISSIONS_METRICTONSCO2E","to_table_name":"PropertyState"},{"from_field":"TOTGHGEMISSINTENSITY_KGCO2EFT","to_field":"TOTGHGEMISSINTENSITY_KGCO2EFT","to_field_display_name":"TOTGHGEMISSINTENSITY_KGCO2EFT","to_table_name":"PropertyState"},{"from_field":"WATERSCORE_MFPROPERTIES","to_field":"WATERSCORE_MFPROPERTIES","to_field_display_name":"WATERSCORE_MFPROPERTIES","to_table_name":"PropertyState"},{"from_field":"WATERUSE_ALLWATERSOURCES_KGAL","to_field":"WATERUSE_ALLWATERSOURCES_KGAL","to_field_display_name":"WATERUSE_ALLWATERSOURCES_KGAL","to_table_name":"PropertyState"},{"from_field":"ENERGYSTARSCORE","to_field":"ENERGYSTARSCORE","to_field_display_name":"ENERGYSTARSCORE","to_table_name":"PropertyState"},{"from_field":"PMPARENTPROPERTYID","to_field":"PMPARENTPROPERTYID","to_field_display_name":"PMPARENTPROPERTYID","to_table_name":"PropertyState"},{"from_field":"PMPROPERTYID","to_field":"PMPROPERTYID","to_field_display_name":"PMPROPERTYID","to_table_name":"PropertyState"},{"from_field":"PROPERTYNAME","to_field":"PROPERTYNAME","to_field_display_name":"PROPERTYNAME","to_table_name":"PropertyState"},{"from_field":"OWNERPROVIDEDPUBLICNOTES","to_field":"OWNERPROVIDEDPUBLICNOTES","to_field_display_name":"OWNERPROVIDEDPUBLICNOTES","to_table_name":"PropertyState"},{"from_field":"SITEEUI_KBTU_FT","to_field":"SITEEUI_KBTU_FT","to_field_display_name":"SITEEUI_KBTU_FT","to_table_name":"PropertyState"},{"from_field":"WEATHERNORMALZEDSITEEUI_KBTUFT","to_field":"WEATHERNORMALZEDSITEEUI_KBTUFT","to_field_display_name":"WEATHERNORMALZEDSITEEUI_KBTUFT","to_table_name":"PropertyState"},{"from_field":"SOURCEEUI_KBTU_FT","to_field":"SOURCEEUI_KBTU_FT","to_field_display_name":"SOURCEEUI_KBTU_FT","to_table_name":"PropertyState"},{"from_field":"WEATHERNORMALZEDSOURCEEUI_KBTUFT","to_field":"WEATHERNORMALZEDSOURCEEUI_KBTUFT","to_field_display_name":"WEATHERNORMALZEDSOURCEEUI_KBTUFT","to_table_name":"PropertyState"},{"from_field":"REPORTSTATUS","to_field":"REPORTSTATUS","to_field_display_name":"REPORTSTATUS","to_table_name":"PropertyState"},{"from_field":"FUELOILANDDIESELFUELUSEKBTU","to_field":"FUELOILANDDIESELFUELUSEKBTU","to_field_display_name":"FUELOILANDDIESELFUELUSEKBTU","to_table_name":"PropertyState"},{"from_field":"REPORTINGYEAR","to_field":"REPORTINGYEAR","to_field_display_name":"REPORTINGYEAR","to_table_name":"PropertyState"},{"from_field":"ELECTRICITYUSE_KBTU_JANUARY","to_field":"ELECTRICITYUSE_KBTU_JANUARY","to_field_display_name":"ELECTRICITYUSE_KBTU_JANUARY","to_table_name":"PropertyState"},{"from_field":"ELECTRICITYUSE_KBTU_FEBRUARY","to_field":"ELECTRICITYUSE_KBTU_FEBRUARY","to_field_display_name":"ELECTRICITYUSE_KBTU_FEBRUARY","to_table_name":"PropertyState"},{"from_field":"ELECTRICITYUSE_KBTU_MARCH","to_field":"ELECTRICITYUSE_KBTU_MARCH","to_field_display_name":"ELECTRICITYUSE_KBTU_MARCH","to_table_name":"PropertyState"},{"from_field":"ELECTRICITYUSE_KBTU_APRIL","to_field":"ELECTRICITYUSE_KBTU_APRIL","to_field_display_name":"ELECTRICITYUSE_KBTU_APRIL","to_table_name":"PropertyState"},{"from_field":"ELECTRICITYUSE_KBTU_MAY","to_field":"ELECTRICITYUSE_KBTU_MAY","to_field_display_name":"ELECTRICITYUSE_KBTU_MAY","to_table_name":"PropertyState"},{"from_field":"ELECTRICITYUSE_KBTU_JUNE","to_field":"ELECTRICITYUSE_KBTU_JUNE","to_field_display_name":"ELECTRICITYUSE_KBTU_JUNE","to_table_name":"PropertyState"},{"from_field":"ELECTRICITYUSE_KBTU_JULY","to_field":"ELECTRICITYUSE_KBTU_JULY","to_field_display_name":"ELECTRICITYUSE_KBTU_JULY","to_table_name":"PropertyState"},{"from_field":"ELECTRICITYUSE_KBTU_AUGUST","to_field":"ELECTRICITYUSE_KBTU_AUGUST","to_field_display_name":"ELECTRICITYUSE_KBTU_AUGUST","to_table_name":"PropertyState"},{"from_field":"ELECTRICITYUSE_KBTU_SEPTEMBER","to_field":"ELECTRICITYUSE_KBTU_SEPTEMBER","to_field_display_name":"ELECTRICITYUSE_KBTU_SEPTEMBER","to_table_name":"PropertyState"},{"from_field":"ELECTRICITYUSE_KBTU_OCTOBER","to_field":"ELECTRICITYUSE_KBTU_OCTOBER","to_field_display_name":"ELECTRICITYUSE_KBTU_OCTOBER","to_table_name":"PropertyState"},{"from_field":"ELECTRICITYUSE_KBTU_NOVEMBER","to_field":"ELECTRICITYUSE_KBTU_NOVEMBER","to_field_display_name":"ELECTRICITYUSE_KBTU_NOVEMBER","to_table_name":"PropertyState"},{"from_field":"ELECTRICITYUSE_KBTU_DECEMBER","to_field":"ELECTRICITYUSE_KBTU_DECEMBER","to_field_display_name":"ELECTRICITYUSE_KBTU_DECEMBER","to_table_name":"PropertyState"},{"from_field":"NATURALGAS_KBTU_JANUARY","to_field":"NATURALGAS_KBTU_JANUARY","to_field_display_name":"NATURALGAS_KBTU_JANUARY","to_table_name":"PropertyState"},{"from_field":"NATURALGAS_KBTU_FEBRUARY","to_field":"NATURALGAS_KBTU_FEBRUARY","to_field_display_name":"NATURALGAS_KBTU_FEBRUARY","to_table_name":"PropertyState"},{"from_field":"NATURALGAS_KBTU_MARCH","to_field":"NATURALGAS_KBTU_MARCH","to_field_display_name":"NATURALGAS_KBTU_MARCH","to_table_name":"PropertyState"},{"from_field":"NATURALGAS_KBTU_APRIL","to_field":"NATURALGAS_KBTU_APRIL","to_field_display_name":"NATURALGAS_KBTU_APRIL","to_table_name":"PropertyState"},{"from_field":"NATURALGAS_KBTU_MAY","to_field":"NATURALGAS_KBTU_MAY","to_field_display_name":"NATURALGAS_KBTU_MAY","to_table_name":"PropertyState"},{"from_field":"NATURALGAS_KBTU_JUNE","to_field":"NATURALGAS_KBTU_JUNE","to_field_display_name":"NATURALGAS_KBTU_JUNE","to_table_name":"PropertyState"},{"from_field":"NATURALGAS_KBTU_JULY","to_field":"NATURALGAS_KBTU_JULY","to_field_display_name":"NATURALGAS_KBTU_JULY","to_table_name":"PropertyState"},{"from_field":"NATURALGAS_KBTU_AUGUST","to_field":"NATURALGAS_KBTU_AUGUST","to_field_display_name":"NATURALGAS_KBTU_AUGUST","to_table_name":"PropertyState"},{"from_field":"NATURALGAS_KBTU_SEPTEMBER","to_field":"NATURALGAS_KBTU_SEPTEMBER","to_field_display_name":"NATURALGAS_KBTU_SEPTEMBER","to_table_name":"PropertyState"},{"from_field":"NATURALGAS_KBTU_OCTOBER","to_field":"NATURALGAS_KBTU_OCTOBER","to_field_display_name":"NATURALGAS_KBTU_OCTOBER","to_table_name":"PropertyState"},{"from_field":"NATURALGAS_KBTU_NOVEMBER","to_field":"NATURALGAS_KBTU_NOVEMBER","to_field_display_name":"NATURALGAS_KBTU_NOVEMBER","to_table_name":"PropertyState"},{"from_field":"NATURALGAS_KBTU_DECEMBER","to_field":"NATURALGAS_KBTU_DECEMBER","to_field_display_name":"NATURALGAS_KBTU_DECEMBER","to_table_name":"PropertyState"},{"from_field":"Merge ID - 1","to_field":"jurisdiction_tax_lot_id","to_field_display_name":"Jurisdiction Tax Lot ID","to_table_name":"TaxLotState"},{"from_field":"Merge ID - 2","to_field":"pm_property_id","to_field_display_name":"PM Property ID","to_table_name":"PropertyState"},{"from_field":"PID","to_field":"PID","to_field_display_name":"PID","to_table_name":"PropertyState"},{"from_field":"DISTRSTEAM_KBTU","to_field":"DISTRSTEAM_KBTU","to_field_display_name":"DISTRSTEAM_KBTU","to_table_name":"PropertyState"},{"from_field":"DISTRCHILLEDWATER_KBTU","to_field":"DISTRCHILLEDWATER_KBTU","to_field_display_name":"DISTRCHILLEDWATER_KBTU","to_table_name":"PropertyState"},{"from_field":"DISTRHOTWATER_KBTU","to_field":"DISTRHOTWATER_KBTU","to_field_display_name":"DISTRHOTWATER_KBTU","to_table_name":"PropertyState"},{"from_field":"ELECTRICITYUSE_RENEWABLE_KWH","to_field":"ELECTRICITYUSE_RENEWABLE_KWH","to_field_display_name":"ELECTRICITYUSE_RENEWABLE_KWH","to_table_name":"PropertyState"},{"from_field":"LASTUPDATE","to_field":"LASTUPDATE","to_field_display_name":"LASTUPDATE","to_table_name":"PropertyState"}]}
		data_map_save = SEEDClient.post_save_column_mappings(SEED_Upload_Data_ID, payload3)
		payload4 = {"remap":True,"mark_as_done":False}
		data_map = SEEDClient.post_perform_mapping(SEED_Upload_Data_ID, payload4)
		prog_check = 0
		while prog_check != 100:
			data_map_status = SEEDClient.get_perform_mapping_status(SEED_Upload_Data_ID)
			data_map_status_temp = json.loads(data_map_status.text)
			prog_check = data_map_status_temp['progress']
			prog_status = data_map_status_temp['status']	
			print (prog_check, prog_status)	
		data_quality_check = SEEDClient.post_data_quality_check_import(SEED_Upload_Data_ID,'313')

		prog_check = 0
		while prog_check != 100:
			data_quality_status = SEEDClient.get_data_quality_check_import_status(SEED_Upload_Data_ID)
			data_quality_status_temp = json.loads(data_quality_status.text)
			prog_check = data_quality_status_temp['progress']
			prog_status = data_quality_status_temp['status_message']
			print (prog_check, prog_status)
		data_map_status = SEEDClient.post_perform_mapping_stop(SEED_Upload_Data_ID,'313')
		data_match = SEEDClient.post_start_matching(SEED_Upload_Data_ID)
		prog_check = 0
		while prog_check != 100:
			data_matching_status = SEEDClient.get_start_matching_status(SEED_Upload_Data_ID)
			data_matching_status_temp = json.loads(data_matching_status.text)
			prog_check = data_matching_status_temp['progress']
			prog_status = data_matching_status_temp['status_message']
			print (prog_check, prog_status)
	"""





